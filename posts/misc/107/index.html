<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>PNG文件结构 - 东隅 Blog</title><meta name="author" content="东隅">
<meta name="author-link" content="">
<meta name="description" content="" /><meta name="keywords" content='MISC' />
  <meta itemprop="name" content="PNG文件结构">
  <meta itemprop="datePublished" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="dateModified" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="wordCount" content="135">
  <meta itemprop="keywords" content="MISC"><meta property="og:url" content="https://dongyu29.github.io/posts/misc/107/">
  <meta property="og:site_name" content="东隅 Blog">
  <meta property="og:title" content="PNG文件结构">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:modified_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:tag" content="MISC">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="PNG文件结构">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://dongyu29.github.io/posts/misc/107/" /><link rel="prev" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/29/" /><link rel="next" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/24/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "PNG文件结构",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/dongyu29.github.io\/posts\/misc\/107\/"
    },"image": ["https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"],"genre": "posts","keywords": "MISC","wordcount":  135 ,
    "url": "https:\/\/dongyu29.github.io\/posts\/misc\/107\/","datePublished": "2024-08-15T09:31:01+08:00","dateModified": "2024-08-15T09:31:01+08:00","publisher": {
      "@type": "Organization",
      "name": "","logo": "https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"},"author": {
        "@type": "Person",
        "name": "东隅"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ></a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ></a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item"><a href="/" title="东隅 Blog">Home</a></li><li class="breadcrumb-item"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" aria-current="page">PNG文件结构</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="Repost" class="icon-repost"><i class="fa-solid x" aria-hidden="true"></i></span><span>PNG文件结构</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅" data-title="东隅" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;东隅</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/misc/" class="post-category" title="Category - MISC"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> MISC</a></span></div><div class="post-meta-line"><span title="published on 2024-08-15 09:31:01"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-08-15">2024-08-15</time></span>&nbsp;<span title="135 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 200 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>One minute</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-特点">1. 特点</a></li>
        <li><a href="#2-文件结构">2. 文件结构</a></li>
        <li><a href="#3-数据块结构">3. 数据块结构</a></li>
        <li><a href="#4-几种png格式">4. 几种PNG格式</a></li>
        <li><a href="#5-与gif比较">5. 与GIF比较</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="-----（完）-----"><h1 id="前言" class="heading-element"><span>前言</span>
  <a href="#%e5%89%8d%e8%a8%80" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><blockquote>
<p>只要是做图片的或者与图片相关的，那么图片的格式就是一个不可以绕过的问题，我们见过很多的图片格式，但是具体不同的图片格式是如何定义的，又具有什么特点，很多时候我们都没有深入研究过，下面我们就开始深入研究。</p>
</blockquote>
<h1 id="几种图片格式" class="heading-element"><span>几种图片格式</span>
  <a href="#%e5%87%a0%e7%a7%8d%e5%9b%be%e7%89%87%e6%a0%bc%e5%bc%8f" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>图片有很多的格式，包括<code>PNG</code>、<code>JPEG</code>、<code>JPG</code>、<code>BMP</code>等，下面我们就详细的说一下这几张图片的格式，并进行详细的对比。</p>
<hr>
<h1 id="png" class="heading-element"><span>PNG</span>
  <a href="#png" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>便携式网络图形<code>（Portable Network Graphics）</code>是一种无损压缩的位图图形格式  。其设计目的是试图替代<code>GIF</code>和<code>TIFF</code>文件格式，同时增加一些GIF文件格式所不具备的特性。PNG的名称来源于“可移植网络图形格式<code>(Portable Network Graphic Format，PNG)</code>”，也有一个非官方解释<code>“PNG's Not GIF”</code>。PNG使用从<code>LZ77</code>派生的无损数据压缩算法，一般应用于JAVA程序、网页或S60程序中，原因是它压缩比高，生成文件体积小。</p>
<h3 id="1-特点" class="heading-element"><span>1. 特点</span>
  <a href="#1-%e7%89%b9%e7%82%b9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>PNG格式的图片具有如下特点：</p>
<ul>
<li>体积小：网络通讯中因受带宽制约，在保证图片清晰、逼真的前提下，网页中不可能大范围的使用文件较大的<code>bmp</code>格式文件。</li>
<li>无损压缩：<code>PNG</code>文件采用<code>LZ77</code>算法的派生算法进行压缩，其结果是获得高的压缩比，不损失数据。它利用特殊的编码方法标记重复出现的数据，因而对图像的颜色没有影响，也不可能产生颜色的损失，这样就可以重复保存而不降低图像质量。</li>
<li>索引彩色模式：<code>PNG-8</code>格式与<code>GIF</code>图像类似，同样采用8位调色板将RGB彩色图像转换为索引彩色图像。图像中保存的不再是各个像素的彩色信息，而是从图像中挑选出来的具有代表性的颜色编号，每一编号对应一种颜色，图像的数据量也因此减少，这对彩色图像的传播非常有利。</li>
<li>更优化的网络传输显示： PNG图像在浏览器上采用流式浏览，即使经过交错处理的图像会在完全下载之前提供浏览者一个基本的图像内容，然后再逐渐清晰起来。它允许连续读出和写入图像数据，这个特性很适合于在通信过程中显示和生成图像。</li>
<li>支持透明效果：PNG可以为原图像定义<code>256</code>个透明层次，使得彩色图像的边缘能与任何背景平滑地融合，从而彻底地消除锯齿边缘。这种功能是<code>GIF</code>和<code>JPEG</code>没有的。</li>
<li>PNG同时还支持真彩和灰度级图像的Alpha通道透明度。</li>
<li>最高支持<code>24</code>位真彩色图像以及<code>8</code>位灰度图像。</li>
<li>支持<code>Alpha</code>通道的透明/半透明特性。</li>
<li>支持图像亮度的<code>Gamma</code>校准信息。</li>
<li>支持存储附加文本信息，以保留图像名称、作者、版权、创作时间、注释等信息。</li>
<li>渐近显示和流式读写，适合在网络传输中快速显示预览效果后再展示全貌。</li>
<li>使用<code>CRC</code>防止文件出错。</li>
<li>最新的<code>PNG</code>标准允许在一个文件内存储多幅图像。</li>
</ul>
<h3 id="2-文件结构" class="heading-element"><span>2. 文件结构</span>
  <a href="#2-%e6%96%87%e4%bb%b6%e7%bb%93%e6%9e%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>PNG图像格式文件（或者称为数据流）由一个8字节的PNG文件署名<code>（PNG file signature）</code>域和按照特定结构组织的3个以上的数据块<code>（chunk）</code>组成。</p>
<p><strong>文件署名域</strong></p>
<p>8字节的PNG文件署名域用来识别该文件是不是PNG文件。该域的值是：</p>
<ul>
<li>十进制数<code>137 80 78 71 13 10 26 10</code></li>
<li>十六进制数 <code>89 50 4e 47 0d 0a 1a 0a</code></li>
</ul>
<p><strong>数据块类型码命名约定</strong></p>
<ul>
<li>辅助位： 第一个字节的第5位是0（大写）=关键，1（小写）=辅助。一个解码器遇到一个不能识别的块时，如果发现辅助位为1则可以放心地忽略该块，并继续显示图像。</li>
<li>私人位：第二个字节的第5位是0（大写）=公用，1（小写）=私人。应用程序也可以定义私有（未注册）块来达到自己的目的。需要注意的是解码器并不需要理会块的私人位——因为它没有功能上的意义，它只是一个管理上的便利，以确保公共块和私人块名称不会冲突。</li>
<li>保留位：第三个字节的第5位必须为0（大写）。该位的意义是为将来可能的扩展保留。</li>
<li>安全拷贝位：第4个字节的第5位是0（大写）=复制不安全，1（小写）=复制安全。
<ul>
<li>该位为0（大写），表示该块的内容随图像数据的更新而更新，如果修改了任何关键数据块（包括增添、修改、删除以及关键块的重新排序），就不要把不能识别且“复制不安全”的块输出到新的png文件中。（如果png编辑器可以识别该块，那么当然可以选择输出适当修改后的版本）</li>
<li>该位为1（小写），表示不论png编辑器是否可以识别该块，也不管png文件被多大程度地修改，该块都可以被拷贝到修改后的png文件中。</li>
<li>如果只有辅助块的增添、删除、修改或辅助块的重新排序，png编辑器将总是被允许将不能识别的辅助块拷贝到修改后的png文件中，这就要求：不论”安全拷贝位“如何设置，一个辅助块都不能仅随其它辅助块的更新而更新。（即，如果在png中加入自定义的辅助块，必须做到当仅更新其他辅助块中的数据时，该辅助块不需要连带更新，否则上述机制就会破坏该辅助块与其余图像数据的一致性）</li>
<li>如果png编辑器遇到一个不能识别的关键块，因为没有办法确定修改包含这种块的文件后png文件还是否有效，所以png编辑器应立刻停止修改这个png文件。（简单地删除这个块的做法不够好，因为这个块还可能与解码其他块有关）</li>
<li>复制安全/不安全的机制是为辅助块设计的。对于关键块，”安全拷贝位“应该总是为0。</li>
</ul>
</li>
</ul>
<h3 id="3-数据块结构" class="heading-element"><span>3. 数据块结构</span>
  <a href="#3-%e6%95%b0%e6%8d%ae%e5%9d%97%e7%bb%93%e6%9e%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>PNG定义了两种类型的数据块，一种是称为关键数据块<code>（critical chunk）</code>，这是必需的数据块，另一种叫做辅助数据块<code>（ancillary chunks）</code>，这是可选的数据块。关键数据块定义了4个标准数据块，每个PNG文件都必须包含它们，PNG读写软件也都必须要支持这些数据块。虽然PNG文件规范没有要求PNG编译码器对可选数据块进行编码和译码，但规范提倡支持可选数据块。</p>
<p>数据块的4个域组成如下图所示。</p>
<p><img loading="lazy" src="https:////upload-images.jianshu.io/upload_images/3691932-197719a7a05d7331.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp" alt="img" srcset="https:////upload-images.jianshu.io/upload_images/3691932-197719a7a05d7331.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp&amp;size=small, https:////upload-images.jianshu.io/upload_images/3691932-197719a7a05d7331.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp&amp;size=medium 1.5x, https:////upload-images.jianshu.io/upload_images/3691932-197719a7a05d7331.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp&amp;size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>下面我们就分析下这个结构。</p>
<ul>
<li>长度：一个4字节的无符号整数，给出数据块的数据字段的长度（以字节计）。 长度只计算数据域，为了兼容一些不支持无符号的语言,所以长度限制在(231 - 1)字节，不能达到(232 - 1)字节。</li>
<li>数据块类型码：一个4字节的块类型代码。 为了便于描述和检查PNG文件，类型代码仅限于大写和小写的ASCII字母（A - Z和a - z，使用十进制ASCII代码表示为65-90和97-122）。 然而，编码器和解码器必须把代码作为固定的二进制值而非字符串来处理。</li>
<li>数据域：数据块的数据域，存储按照数据块类型码指定的数据（如果有的话）。 该字段可以是长度为零。</li>
<li>循环冗余检测：一个4字节的CRC（循环冗余校验）计算，在所述块的前面的字节，包括该块类型的代码和数据块的数据字段，但是不包括长度字段。 CRC始终存在，即使不包含数据块。<code>CRC(cyclic redundancy check）</code>域中的值是对<code>Chunk Type Code</code>域和<code>Chunk Data</code>域中的数据进行计算得到的。CRC具体算法定义在<code>ISO 3309</code>和<code>ITU-T V.42</code>中。</li>
</ul>
<p><strong>关键数据块</strong></p>
<p>关键数据块的组成如下所示。</p>
<p><img loading="lazy" src="https:////upload-images.jianshu.io/upload_images/3691932-16ca1afebad97328.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/423/format/webp" alt="img" srcset="https:////upload-images.jianshu.io/upload_images/3691932-16ca1afebad97328.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/423/format/webp&amp;size=small, https:////upload-images.jianshu.io/upload_images/3691932-16ca1afebad97328.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/423/format/webp&amp;size=medium 1.5x, https:////upload-images.jianshu.io/upload_images/3691932-16ca1afebad97328.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/423/format/webp&amp;size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<ul>
<li><code>IHDR</code>：文件头数据块<code>IHDR(header chunk)</code>：它包含有PNG文件中存储的图像数据的基本信息，并要作为第一个数据块出现在PNG数据流中，而且一个PNG数据流中只能有一个文件头数据块。</li>
<li><code>PLTE</code>：调色板数据块<code>PLTE(palette chunk)</code>包含有与索引彩色图像<code>(indexed-color image)</code>相关的彩色变换数据，它仅与索引彩色图像有关，而且要放在图像数据块<code>(image data chunk)</code>之前。PLTE数据块是定义图像的调色板信息，PLTE可以包含1~256个调色板信息，每一个调色板信息由3个字节组成。</li>
<li><code>IDAT</code>：图像数据块<code>IDAT(image data chunk)</code>：它存储实际的数据，在数据流中可包含多个连续顺序的图像数据块。IDAT存放着图像真正的数据信息，因此，如果能够了解IDAT的结构，我们就可以很方便的生成PNG图像。</li>
<li><code>IEND</code>：图像结束数据<code>IEND(image trailer chunk)</code>：它用来标记PNG文件或者数据流已经结束，并且必须要放在文件的尾部。如果我们仔细观察PNG文件，我们会发现，文件的结尾12个字符看起来总应该是这样的：
<code>0000000049454E44AE426082</code>，不难明白，由于数据块结构的定义，IEND数据块的长度总是0（<code>00 00 00 00</code>，除非人为加入信息），数据标识总是<code>IEND（49 45 4E 44）</code>，因此，CRC码也总是<code>AE 42 60 82</code>。</li>
</ul>
<p><strong>辅助数据块</strong></p>
<p>看下面这个数据结构图。</p>
<p><img loading="lazy" src="https:////upload-images.jianshu.io/upload_images/3691932-7a8d9d86905e491e.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp" alt="img" srcset="https:////upload-images.jianshu.io/upload_images/3691932-7a8d9d86905e491e.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp&amp;size=small, https:////upload-images.jianshu.io/upload_images/3691932-7a8d9d86905e491e.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp&amp;size=medium 1.5x, https:////upload-images.jianshu.io/upload_images/3691932-7a8d9d86905e491e.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/662/format/webp&amp;size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="4-几种png格式" class="heading-element"><span>4. 几种PNG格式</span>
  <a href="#4-%e5%87%a0%e7%a7%8dpng%e6%a0%bc%e5%bc%8f" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>PNG格式有8位、24位、32位三种形式，其中8位PNG支持两种不同的透明形式（索引透明和alpha透明），24位PNG不支持透明，32位PNG在24位基础上增加了8位透明通道，因此可展现256级透明程度。
PNG8和PNG24后面的数字则是代表这种PNG格式最多可以索引和存储的颜色值。”8″代表2的8次方也就是256色，而24则代表2的24次方大概有1600多万色。</p>
<p>具体如下图所示。</p>
<p><img loading="lazy" src="https:////upload-images.jianshu.io/upload_images/3691932-f70662382576e713.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/696/format/webp" alt="img" srcset="https:////upload-images.jianshu.io/upload_images/3691932-f70662382576e713.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/696/format/webp&amp;size=small, https:////upload-images.jianshu.io/upload_images/3691932-f70662382576e713.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/696/format/webp&amp;size=medium 1.5x, https:////upload-images.jianshu.io/upload_images/3691932-f70662382576e713.png?imageMogr2/auto-orient/strip%7cimageView2/2/w/696/format/webp&amp;size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="5-与gif比较" class="heading-element"><span>5. 与GIF比较</span>
  <a href="#5-%e4%b8%8egif%e6%af%94%e8%be%83" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>一般情况下将静态GIF图像无损转换为PNG后可以压缩率会略为提高（前提是同样采用8位索引模式）。</li>
<li>PNG可提供更大颜色深度的支持，包括24位（8位3通道）和48位（16位3通道）真彩色。加入α通道后可进一步支持每像素64位的表示。</li>
<li>超过8位色深的PNG图像转换为GIF时，图像质量会由于分色（颜色数减少）而下降。</li>
<li>GIF原生支持动态图像，PNG只能通过非标准实现，在PNG的基础上另有发展出支持动画的APNG和MNG格式，但目前普及度不高。</li>
</ul></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2024-08-15 09:31:01">Updated on 2024-08-15&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/misc/" class="post-tag" title="Tags - MISC">MISC</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/29/" class="post-nav-item" rel="prev" title="Python Flask SSTI"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Python Flask SSTI</a>
      <a href="/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/24/" class="post-nav-item" rel="next" title="Php绕过open_basedir">Php绕过open_basedir<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.132.1">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.9">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">东隅</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/instant-page/instantpage.min.js" async defer type="module"></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":20},"comment":{"enable":false},"typeit":{"cursorChar":"_","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.9"};</script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-YMSM8DYT3D', { 'anonymize_ip': true });
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-YMSM8DYT3D" async></script></body>
</html>
